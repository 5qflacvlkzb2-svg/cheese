
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="naver-site-verification" content="a37ea649edf26e70c3de94f9cb034f9d6e11de3f" />
    <meta name="generator" content="Yun Blog">
    <title>JPA 기반 테스트 코드 작성 팁 - Yun Blog</title>
    <meta name="author" content="Yun">
    
        <meta name="keywords" content="Node,Spring,Spring Boot,Spring Batch,Kotlin,기술 블로그,JPA,Mongo,MySQL,OOP,">
    
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yun","sameAs":["https://github.com/cheese10yun"],"image":"yun-icon.jpg"},"articleBody":"JPA 기반으로 테스트 코드를 작성하면서 불편했던 부분을 소개하고 해결 방법에 관한 포스팅입니다.\nJPA 기반 테스트 불편한 점과도한 Dependency1234567891011121314internal class JpaTest(    private val paymentRepository: PaymentRepository,    private val memberRepository: MemberRepository,    private val orderRepository: OrderRepository) : SpringBootTestSupport() &#123;    @Test    internal fun `특정 테스트를 하기위해서는 외부 dependency가 필요하다`() &#123;        // 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.        paymentRepository.save(Payment(BigDecimal.TEN))        memberRepository.save(Member(&quot;username&quot;, 10, Team(&quot;team-name&quot;)))        orderRepository.save(Order(BigDecimal.TEN))    &#125;&#125;\n많은 디펜던시가 필요한 부분의 테스트 코드를 작성할 때는 많은 Repository를 주입 받아서 테스트를 진헹 해야합니다. 위 코드처럼 특정 구간의 서비스를 테스트하기 위해서는 Given절을 작성할 때 흔하게 발생합니다.\n물론 테스트 코드이기 때문에 DI 받아야하는 항목들이 많아지는것이 상대적으로 문제가 크게 발생하지는 않지만 코드 양이 많이 발생하는 문제가 있습니다.\n검증이 필요한데 ?…무엇보다 큰 문제가 해당 테스트의 Then절에 있습니다. \n12345678910111213@Testinternal fun `특정 테스트를 하기위해서는 외부 dependency가 필요하다`() &#123;    // 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.    paymentRepository.save(Payment(BigDecimal.TEN))    memberRepository.save(Member(&quot;username&quot;, 10, Team(&quot;team-name&quot;)))    orderRepository.save(Order(BigDecimal.TEN))    // 특정 서비스가 여러 entity rows를 변경할때 아래와 같은 조회로 Then 이어가야 합니다.    // paymentRepository.findBy... epository 메서드는 없는데??...    // memberRepository.findBy...    // orderRepository.findBy...&#125;\n해당 서비스의 코드가 여러 enttiy의 여러 row의 변경을 가할 때 Then절에서 검증을 진행할 때 문제가 발생합니다. 해당 조회 코드가 없는 경우 오직 테스트를 위해서만 조회용 코드를 일반 코드에 작성해야 합니다. 그렇지 않다면 Test Scope에서 사용할 Repository를 따로 작성해야 합니다.\n두 방식 모두 좋은 해결 방법이 아니라고 생각합니다.\n해결 방법1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@SpringBootTest@TestConstructor(autowireMode = TestConstructor.AutowireMode.ALL)@ActiveProfiles(&quot;test&quot;)abstract class SpringBootTestSupport &#123;    @Autowired    protected lateinit var entityManagerFactory: EntityManagerFactory    @Autowired    protected lateinit var query: JPAQueryFactory    protected val entityManager: EntityManager by lazy &#123;        entityManagerFactory.createEntityManager()    &#125;    protected val transaction: EntityTransaction by lazy &#123;        entityManager.transaction    &#125;    protected fun &lt;T&gt; save(entity: T): T &#123;        transaction.begin()        try &#123;            entityManager.persist(entity)            entityManager.flush() // transaction commit시 자동으로 flush 발생시키나 명시적으로 선언            transaction.commit()            entityManager.clear()        &#125; catch (e: Exception) &#123;            transaction.rollback()        &#125;        return entity    &#125;    protected fun &lt;T&gt; saveAll(entities: Iterable&lt;T&gt;): Iterable&lt;T&gt; &#123;        transaction.begin()        for (entity in entities) &#123;            try &#123;                entityManager.persist(entity)                entityManager.flush() // transaction commit시 자동으로 flush 발생시키나 명시적으로 선언                transaction.commit()                entityManager.clear()            &#125; catch (e: Exception) &#123;                transaction.rollback()            &#125;        &#125;        return entities    &#125;&#125;\n해결 방법은 테스트 코드를 위해서 필요한 기능을 제공해 주는 SpringBootTestSupport을 제공해 주는 것입니다. 자세한 코드는 아래에서 설명하겠습니다.\n과도한 Dependency 해결 방법12345678910111213141516171819202122232425262728293031protected fun &lt;T&gt; save(entity: T): T &#123;    transaction.begin()    try &#123;        entityManager.persist(entity)        entityManager.flush() // transaction commit시 자동으로 flush 발생시키나 명시적으로 선언        transaction.commit()        entityManager.clear()    &#125; catch (e: Exception) &#123;        transaction.rollback()    &#125;    return entity&#125;protected fun &lt;T&gt; saveAll(entities: Iterable&lt;T&gt;): Iterable&lt;T&gt; &#123;    transaction.begin()    for (entity in entities) &#123;        try &#123;            entityManager.persist(entity)            entityManager.flush() // transaction commit시 자동으로 flush 발생시키나 명시적으로 선언            transaction.commit()            entityManager.clear()        &#125; catch (e: Exception) &#123;            transaction.rollback()        &#125;    &#125;    return entities&#125;\nGiven절에서 작성하는 데이터 Set up이기 때문에 트랜잭션을 완전히 분리하기 위해서 transactionn을 commit을 직접 수행 시킵니다. transaction commit 시에 flush가 동작하지만 명시적으로 코드를 작성했습니다.\n주의해야할 점은\n1entityManager.clear()\nEntityManager를 이용해서 clear()을 강제로 발생시키는 있는 점입니다.\n\n영속성 컨텍스트는 1차 캐시를 우선시 합니다. 즉 추가적인 JPQL 쿼리로 조회한 값이 영속성 컨텍스트에 존재하는 경우(식별자 값으로 동일성을 판단함) JPQL로 조회한 데이터를 버립니다. 즉 1차 캐시된것을 우선시합니다. \n그러기 때문에 EntityManager를 이용해서 영속성 컨텍스트를 초기화하는 것입니다. 자세한 내용은 JPA 벌크 작업 주의점 - 영속성 컨텍스트는 1차 캐시된 것이 우선이다. 포스팅을 참고해 주세요\n그리고 Give절에 작성하는 데이터는 이미 데이터베이스에 영속화되어 있다는 개념으로 테스트하는 것이니 이런 문제가 없더라도 최대한 동일한 환경을 구성해주는 것이 좋다고 생각합니다.\n1234567891011@Transactionalinternal class JpaTestSupport : SpringBootTestSupport() &#123;    @Test    internal fun `entityManager를 이용해서 dependency가 최소화 `() &#123;        // 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.        save(Payment(BigDecimal.TEN))        save(Member(&quot;username&quot;, 10, save(Team(&quot;team-ename&quot;))))        save(Coupon(BigDecimal.TEN))    &#125;&#125;\nEntity의 영속성을 EnttiyManager를 통해서 진행하기 때문에 단순 save를 위해서 DI 받는 Repository가 없어졌습니다. \n검증이 필요한데 ?… 해결방법123456789101112131415@Configurationclass Configuration &#123;    @Bean    fun query(entityManager: EntityManager): JPAQueryFactory &#123;        return JPAQueryFactory(entityManager)    &#125;&#125;...abstract class SpringBootTestSupport &#123;    ...    @Autowired    protected lateinit var query: JPAQueryFactory&#125;\nJPAQueryFactory을 query으로 Bean 등록을 진행합니다. Test Scope에서만 사용하는 것을 원하는 경우에는 Test directory에 @TestConfiguration으로 지정해도 됩니다.\nquery을 이용해서 테스트 코드 검증을 진행할 수 있습니다.\n1234567891011121314151617181920212223242526272829@Transactionalinternal class JpaTestSupport : SpringBootTestSupport() &#123;    @Test    internal fun `entityManager를 이용해서 dependency가 최소화 `() &#123;        // 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.        save(Payment(BigDecimal.TEN))        save(Member(&quot;username&quot;, 10, save(Team(&quot;team-ename&quot;))))        save(Coupon(BigDecimal.TEN))        // 특정 서비스가 여러 entity rows를 변경할때 아래와 같은 조회로 Then 이어가야 합니다.        // paymentRepository.findBy... epository 메서드는 없는데??...        // memberRepository.findBy...        // couponRepository.findBy...        val payments = query.selectFrom(QPayment.payment)            .where(QPayment.payment.amount.gt(BigDecimal.TEN))            .fetch()        val members = query.select(QMember.member.age)            .from(QMember.member)            .where(QMember.member.age.gt(20))            .fetch()        val coupons = query.selectFrom(QCoupon.coupon)            .where(QCoupon.coupon.amount.eq(123.toBigDecimal()))            .fetch()    &#125;&#125;\n여러 엔티티의 여러 row의 수정을 진행했을 경우 해당 엔티티의 변경을 확인하기 위한 검증이 필요합니다. 이때 조회용 메서드를 단순히 테스트 코드에서만 사용하기 위해서 작성하기 위해서 작성하거나 Test Scope에 별도의 Repository를 구성해야 했지만 이제는 위에서 등록한 query을 이용해서 해당 비즈니스에 맞는 쿼리를 작성할 수 있습니다.\n1234567891011121314151617181920212223internal class PaymentServiceTest(    private val paymentService: PaymentService) : SpringBootTestSupport() &#123;    @Test    internal fun `paymentZero test`() &#123;        //given        val targetAmount = 105.toBigDecimal()        saveAll((1..100).map &#123;            Payment(it.toBigDecimal().plus(BigDecimal.TEN).setScale(0))        &#125;)        //when        paymentService.paymentZero(targetAmount)        //then        val count = query            .selectFrom(qPayment)            .where(qPayment.amount.gt(targetAmount))            .fetchCount()        then(count).isEqualTo(0)    &#125;\n이런 식으로 심플하게 테스트 코드를 작성할 수 있습니다.\n주의할 점SpringBootTestSupport 클래스에서 정의한 save(), saveAll() 메서드를 사용하는 경우 테스트에서 사용하는 트랜잭션과 완전하게 분리가 됩니다. \n스프링 테스트에서는 @Transactional이 있는 경우 해당 테스트 메서드가 종료되면 트랜잭션으로 같이 Rollback이 진행되게 됩니다. 하지만 SpringBootTestSupport에서 작성한 save(), saveAll()메서드 같은 경우에는 완전히 다른 트랜잭션이므로 given절에서 작성한 트랜잭션이 롤백 되지 않습니다.\n마무리테스트 코드의 중요성의 강조는 의미 없을 정도로 현업에서 자리 잡았다고 생각합니다. 이렇게 중요성이 있는 부분이니 테스트 코드를 작성하기 편한 방법도 많이 연구되었으면 좋겠다는 생각이 있습니다.\n","dateCreated":"2020-03-01T00:00:00+09:00","dateModified":"2025-01-31T04:44:51+09:00","datePublished":"2020-03-01T00:00:00+09:00","description":"JPA 기반으로 테스트 코드를 작성하면서 불편했던 부분을 소개하고 해결 방법에 관한 포스팅입니다.","headline":"JPA 기반 테스트 코드 작성 팁","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://cheese10yun.github.io/jpa-test-support/"},"publisher":{"@type":"Organization","name":"Yun","sameAs":["https://github.com/cheese10yun"],"image":"yun-icon.jpg","logo":{"@type":"ImageObject","url":"yun-icon.jpg"}},"url":"https://cheese10yun.github.io/jpa-test-support/","keywords":"JPA, ORM, Test"}</script>
    <meta name="description" content="JPA 기반으로 테스트 코드를 작성하면서 불편했던 부분을 소개하고 해결 방법에 관한 포스팅입니다.">
<meta property="og:type" content="blog">
<meta property="og:title" content="JPA 기반 테스트 코드 작성 팁">
<meta property="og:url" content="https://cheese10yun.github.io/jpa-test-support/index.html">
<meta property="og:site_name" content="Yun Blog">
<meta property="og:description" content="JPA 기반으로 테스트 코드를 작성하면서 불편했던 부분을 소개하고 해결 방법에 관한 포스팅입니다.">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://github.com/cheese10yun/blog-sample/raw/master/query-dsl/docs/images/query-result-.png">
<meta property="article:published_time" content="2020-02-29T15:00:00.000Z">
<meta property="article:modified_time" content="2025-01-30T19:44:51.981Z">
<meta property="article:author" content="Yun">
<meta property="article:tag" content="JPA">
<meta property="article:tag" content="ORM">
<meta property="article:tag" content="Test">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://github.com/cheese10yun/blog-sample/raw/master/query-dsl/docs/images/query-result-.png">
    
    
        
    
    
        <meta property="og:image" content="https://cheese10yun.github.io/assets/images/yun-icon.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90907312-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-90907312-1');
    </script>


    

    
        
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5813739623204880" crossorigin="anonymous"></script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Yun Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="저자에 대해 더 알아보기"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
                </a>
                <h4 class="sidebar-profile-name">Yun</h4>
                
                    <h5 class="sidebar-profile-bio"><p>기술 블로그</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="카테고리"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="태그"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="아카이브"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="검색"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">검색</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/cheese10yun"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/rss2.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            JPA 기반 테스트 코드 작성 팁
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-03-01T00:00:00+09:00">
	
		    2020/03/01
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>JPA 기반으로 테스트 코드를 작성하면서 불편했던 부분을 소개하고 해결 방법에 관한 포스팅입니다.</p>
<h2 id="JPA-기반-테스트-불편한-점"><a href="#JPA-기반-테스트-불편한-점" class="headerlink" title="JPA 기반 테스트 불편한 점"></a>JPA 기반 테스트 불편한 점</h2><h3 id="과도한-Dependency"><a href="#과도한-Dependency" class="headerlink" title="과도한 Dependency"></a>과도한 Dependency</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title class_">JpaTest</span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> paymentRepository: PaymentRepository,</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> memberRepository: MemberRepository,</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> orderRepository: OrderRepository</span><br><span class="line">) : SpringBootTestSupport() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> `특정 테스트를 하기위해서는 외부 dependency가 필요하다`<span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.</span></span><br><span class="line">        paymentRepository.save(Payment(BigDecimal.TEN))</span><br><span class="line">        memberRepository.save(Member(<span class="string">&quot;username&quot;</span>, <span class="number">10</span>, Team(<span class="string">&quot;team-name&quot;</span>)))</span><br><span class="line">        orderRepository.save(Order(BigDecimal.TEN))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>많은 디펜던시가 필요한 부분의 테스트 코드를 작성할 때는 많은 Repository를 주입 받아서 테스트를 진헹 해야합니다. 위 코드처럼 특정 구간의 서비스를 테스트하기 위해서는 <code>Given</code>절을 작성할 때 흔하게 발생합니다.</p>
<p>물론 테스트 코드이기 때문에 DI 받아야하는 항목들이 많아지는것이 상대적으로 문제가 크게 발생하지는 않지만 코드 양이 많이 발생하는 문제가 있습니다.</p>
<h3 id="검증이-필요한데-…"><a href="#검증이-필요한데-…" class="headerlink" title="검증이 필요한데 ?…"></a>검증이 필요한데 ?…</h3><p>무엇보다 큰 문제가 해당 테스트의 <code>Then</code>절에 있습니다. </p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> `특정 테스트를 하기위해서는 외부 dependency가 필요하다`<span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.</span></span><br><span class="line">    paymentRepository.save(Payment(BigDecimal.TEN))</span><br><span class="line">    memberRepository.save(Member(<span class="string">&quot;username&quot;</span>, <span class="number">10</span>, Team(<span class="string">&quot;team-name&quot;</span>)))</span><br><span class="line">    orderRepository.save(Order(BigDecimal.TEN))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 특정 서비스가 여러 entity rows를 변경할때 아래와 같은 조회로 Then 이어가야 합니다.</span></span><br><span class="line">    <span class="comment">// paymentRepository.findBy... epository 메서드는 없는데??...</span></span><br><span class="line">    <span class="comment">// memberRepository.findBy...</span></span><br><span class="line">    <span class="comment">// orderRepository.findBy...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>해당 서비스의 코드가 여러 enttiy의 여러 row의 변경을 가할 때 <code>Then</code>절에서 검증을 진행할 때 문제가 발생합니다. 해당 조회 코드가 없는 경우 <strong>오직 테스트를 위해서만 조회용 코드를 일반 코드에 작성해야 합니다.</strong> 그렇지 않다면 <strong>Test Scope에서 사용할 Repository를 따로 작성해야 합니다.</strong></p>
<p>두 방식 모두 좋은 해결 방법이 아니라고 생각합니다.</p>
<h2 id="해결-방법"><a href="#해결-방법" class="headerlink" title="해결 방법"></a>해결 방법</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@TestConstructor(autowireMode = TestConstructor.AutowireMode.ALL)</span></span><br><span class="line"><span class="meta">@ActiveProfiles(<span class="string">&quot;test&quot;</span>)</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SpringBootTestSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> entityManagerFactory: EntityManagerFactory</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> query: JPAQueryFactory</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">val</span> entityManager: EntityManager <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        entityManagerFactory.createEntityManager()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">val</span> transaction: EntityTransaction <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        entityManager.transaction</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">save</span><span class="params">(entity: <span class="type">T</span>)</span></span>: T &#123;</span><br><span class="line">        transaction.begin()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            entityManager.persist(entity)</span><br><span class="line">            entityManager.flush() <span class="comment">// transaction commit시 자동으로 flush 발생시키나 명시적으로 선언</span></span><br><span class="line">            transaction.commit()</span><br><span class="line">            entityManager.clear()</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">            transaction.rollback()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> entity</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">saveAll</span><span class="params">(entities: <span class="type">Iterable</span>&lt;<span class="type">T</span>&gt;)</span></span>: Iterable&lt;T&gt; &#123;</span><br><span class="line">        transaction.begin()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (entity <span class="keyword">in</span> entities) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                entityManager.persist(entity)</span><br><span class="line">                entityManager.flush() <span class="comment">// transaction commit시 자동으로 flush 발생시키나 명시적으로 선언</span></span><br><span class="line">                transaction.commit()</span><br><span class="line">                entityManager.clear()</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">                transaction.rollback()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> entities</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>해결 방법은 테스트 코드를 위해서 필요한 기능을 제공해 주는 <code>SpringBootTestSupport</code>을 제공해 주는 것입니다. 자세한 코드는 아래에서 설명하겠습니다.</p>
<h3 id="과도한-Dependency-해결-방법"><a href="#과도한-Dependency-해결-방법" class="headerlink" title="과도한 Dependency 해결 방법"></a>과도한 Dependency 해결 방법</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">save</span><span class="params">(entity: <span class="type">T</span>)</span></span>: T &#123;</span><br><span class="line">    transaction.begin()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        entityManager.persist(entity)</span><br><span class="line">        entityManager.flush() <span class="comment">// transaction commit시 자동으로 flush 발생시키나 명시적으로 선언</span></span><br><span class="line">        transaction.commit()</span><br><span class="line">        entityManager.clear()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">        transaction.rollback()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> entity</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">saveAll</span><span class="params">(entities: <span class="type">Iterable</span>&lt;<span class="type">T</span>&gt;)</span></span>: Iterable&lt;T&gt; &#123;</span><br><span class="line">    transaction.begin()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (entity <span class="keyword">in</span> entities) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            entityManager.persist(entity)</span><br><span class="line">            entityManager.flush() <span class="comment">// transaction commit시 자동으로 flush 발생시키나 명시적으로 선언</span></span><br><span class="line">            transaction.commit()</span><br><span class="line">            entityManager.clear()</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e: Exception) &#123;</span><br><span class="line">            transaction.rollback()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> entities</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Given</code>절에서 작성하는 데이터 Set up이기 때문에 <strong>트랜잭션을 완전히 분리하기 위해서 transactionn을 commit을 직접 수행 시킵니다.</strong> transaction commit 시에 flush가 동작하지만 명시적으로 코드를 작성했습니다.</p>
<p>주의해야할 점은</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entityManager.clear()</span><br></pre></td></tr></table></figure>
<p><strong>EntityManager를 이용해서 clear()을 강제로 발생시키는 있는 점입니다.</strong></p>
<p><img src="https://github.com/cheese10yun/blog-sample/raw/master/query-dsl/docs/images/query-result-.png"></p>
<p>영속성 컨텍스트는 1차 캐시를 우선시 합니다. 즉 추가적인 JPQL 쿼리로 조회한 값이 영속성 컨텍스트에 존재하는 경우(식별자 값으로 동일성을 판단함) JPQL로 조회한 데이터를 버립니다. <strong>즉 1차 캐시된것을 우선시합니다.</strong> </p>
<p>그러기 때문에 EntityManager를 이용해서 <strong>영속성 컨텍스트를 초기화하는 것입니다.</strong> 자세한 내용은 <a href="https://cheese10yun.github.io/jpa-bulk/#1">JPA 벌크 작업 주의점 - 영속성 컨텍스트는 1차 캐시된 것이 우선이다.</a> 포스팅을 참고해 주세요</p>
<p>그리고 <code>Give</code>절에 작성하는 데이터는 이미 데이터베이스에 영속화되어 있다는 개념으로 테스트하는 것이니 이런 문제가 없더라도 최대한 동일한 환경을 구성해주는 것이 좋다고 생각합니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title class_">JpaTestSupport</span> : <span class="type">SpringBootTestSupport</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> `entityManager를 이용해서 dependency가 최소화 `<span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.</span></span><br><span class="line">        save(Payment(BigDecimal.TEN))</span><br><span class="line">        save(Member(<span class="string">&quot;username&quot;</span>, <span class="number">10</span>, save(Team(<span class="string">&quot;team-ename&quot;</span>))))</span><br><span class="line">        save(Coupon(BigDecimal.TEN))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Entity의 영속성을 EnttiyManager를 통해서 진행하기 때문에 단순 save를 위해서 DI 받는 Repository가 없어졌습니다. </p>
<h3 id="검증이-필요한데-…-해결방법"><a href="#검증이-필요한데-…-해결방법" class="headerlink" title="검증이 필요한데 ?… 해결방법"></a>검증이 필요한데 ?… 해결방법</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Configuration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">query</span><span class="params">(entityManager: <span class="type">EntityManager</span>)</span></span>: JPAQueryFactory &#123;</span><br><span class="line">        <span class="keyword">return</span> JPAQueryFactory(entityManager)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SpringBootTestSupport</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> query: JPAQueryFactory</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>JPAQueryFactory</code>을 <code>query</code>으로 Bean 등록을 진행합니다. Test Scope에서만 사용하는 것을 원하는 경우에는 Test directory에 <code>@TestConfiguration</code>으로 지정해도 됩니다.</p>
<p><code>query</code>을 이용해서 테스트 코드 검증을 진행할 수 있습니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title class_">JpaTestSupport</span> : <span class="type">SpringBootTestSupport</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> `entityManager를 이용해서 dependency가 최소화 `<span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 특정 테스트를 하기 위해서 많은 디펜던시가 필요하다.</span></span><br><span class="line">        save(Payment(BigDecimal.TEN))</span><br><span class="line">        save(Member(<span class="string">&quot;username&quot;</span>, <span class="number">10</span>, save(Team(<span class="string">&quot;team-ename&quot;</span>))))</span><br><span class="line">        save(Coupon(BigDecimal.TEN))</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 특정 서비스가 여러 entity rows를 변경할때 아래와 같은 조회로 Then 이어가야 합니다.</span></span><br><span class="line">        <span class="comment">// paymentRepository.findBy... epository 메서드는 없는데??...</span></span><br><span class="line">        <span class="comment">// memberRepository.findBy...</span></span><br><span class="line">        <span class="comment">// couponRepository.findBy...</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> payments = query.selectFrom(QPayment.payment)</span><br><span class="line">            .<span class="keyword">where</span>(QPayment.payment.amount.gt(BigDecimal.TEN))</span><br><span class="line">            .fetch()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> members = query.select(QMember.member.age)</span><br><span class="line">            .from(QMember.member)</span><br><span class="line">            .<span class="keyword">where</span>(QMember.member.age.gt(<span class="number">20</span>))</span><br><span class="line">            .fetch()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">val</span> coupons = query.selectFrom(QCoupon.coupon)</span><br><span class="line">            .<span class="keyword">where</span>(QCoupon.coupon.amount.eq(<span class="number">123.</span>toBigDecimal()))</span><br><span class="line">            .fetch()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>여러 엔티티의 여러 row의 수정을 진행했을 경우 해당 엔티티의 변경을 확인하기 위한 검증이 필요합니다. 이때 조회용 메서드를 단순히 테스트 코드에서만 사용하기 위해서 작성하기 위해서 작성하거나 Test Scope에 별도의 Repository를 구성해야 했지만 이제는 위에서 등록한 <code>query</code>을 이용해서 해당 비즈니스에 맞는 쿼리를 작성할 수 있습니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title class_">PaymentServiceTest</span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> paymentService: PaymentService</span><br><span class="line">) : SpringBootTestSupport() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> `paymentZero test`<span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">//given</span></span><br><span class="line">        <span class="keyword">val</span> targetAmount = <span class="number">105.</span>toBigDecimal()</span><br><span class="line">        saveAll((<span class="number">1.</span><span class="number">.100</span>).map &#123;</span><br><span class="line">            Payment(it.toBigDecimal().plus(BigDecimal.TEN).setScale(<span class="number">0</span>))</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//when</span></span><br><span class="line">        paymentService.paymentZero(targetAmount)</span><br><span class="line"></span><br><span class="line">        <span class="comment">//then</span></span><br><span class="line">        <span class="keyword">val</span> count = query</span><br><span class="line">            .selectFrom(qPayment)</span><br><span class="line">            .<span class="keyword">where</span>(qPayment.amount.gt(targetAmount))</span><br><span class="line">            .fetchCount()</span><br><span class="line"></span><br><span class="line">        then(count).isEqualTo(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>이런 식으로 심플하게 테스트 코드를 작성할 수 있습니다.</p>
<h2 id="주의할-점"><a href="#주의할-점" class="headerlink" title="주의할 점"></a>주의할 점</h2><p><code>SpringBootTestSupport</code> 클래스에서 정의한 <code>save()</code>, <code>saveAll()</code> 메서드를 사용하는 경우 테스트에서 사용하는 트랜잭션과 완전하게 분리가 됩니다. </p>
<p>스프링 테스트에서는 <code>@Transactional</code>이 있는 경우 해당 테스트 메서드가 종료되면 트랜잭션으로 같이 Rollback이 진행되게 됩니다. 하지만 <code>SpringBootTestSupport</code>에서 작성한 <code>save()</code>, <code>saveAll()</code>메서드 같은 경우에는 완전히 다른 트랜잭션이므로 <code>given</code>절에서 작성한 트랜잭션이 롤백 되지 않습니다.</p>
<h2 id="마무리"><a href="#마무리" class="headerlink" title="마무리"></a>마무리</h2><p>테스트 코드의 중요성의 강조는 의미 없을 정도로 현업에서 자리 잡았다고 생각합니다. 이렇게 중요성이 있는 부분이니 테스트 코드를 작성하기 편한 방법도 많이 연구되었으면 좋겠다는 생각이 있습니다.</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/JPA/" rel="tag">JPA</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/ORM/" rel="tag">ORM</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Test/" rel="tag">Test</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-mock-test/"
                    data-tooltip="외부 인프라스트럭처 테스트"
                    aria-label="이전: 외부 인프라스트럭처 테스트"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/querydsl-support/"
                    data-tooltip="Querydsl Repository Support 활용"
                    aria-label="다음: Querydsl Repository Support 활용"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/jpa-test-support/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/jpa-test-support/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://cheese10yun.github.io/jpa-test-support/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>


<!-- Comment -->
<!--  utteranc comment -->

<script src="https://utteranc.es/client.js"
        repo="cheese10yun/blog-comment"
        issue-term="title"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Yun. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-mock-test/"
                    data-tooltip="외부 인프라스트럭처 테스트"
                    aria-label="이전: 외부 인프라스트럭처 테스트"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/querydsl-support/"
                    data-tooltip="Querydsl Repository Support 활용"
                    aria-label="다음: Querydsl Repository Support 활용"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/jpa-test-support/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/jpa-test-support/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://cheese10yun.github.io/jpa-test-support/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/jpa-test-support/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/jpa-test-support/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://cheese10yun.github.io/jpa-test-support/"
                        aria-label="Google+에 공유하기"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
        
            <h4 id="about-card-name">Yun</h4>
        
            <div id="about-card-bio"><p>기술 블로그</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
