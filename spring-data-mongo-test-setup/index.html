
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="naver-site-verification" content="a37ea649edf26e70c3de94f9cb034f9d6e11de3f" />
    <meta name="generator" content="Yun Blog">
    <title>MongoDB 다양한 테스트 케이스를 커버할 수 있는 테스트 데이터 셋업 방법 - Yun Blog</title>
    <meta name="author" content="Yun">
    
        <meta name="keywords" content="Node,Spring,Spring Boot,Spring Batch,Kotlin,기술 블로그,JPA,Mongo,MySQL,OOP,">
    
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yun","sameAs":["https://github.com/cheese10yun"],"image":"yun-icon.jpg"},"articleBody":"테스트 코드의 가치가 널리 인정받으며, 이제 그 필요성을 언급하는 것은 의미가 없어졌습니다. 테스트 코드의 가장 큰 매력은 바로 구현 코드에 대한 실시간 피드백을 제공하고, 이를 바탕으로 구현 코드를 지속적으로 개선해 나갈 수 있다는 점입니다. 이 개념은 “실무에서 적용하는 테스트 코드 작성 방법과 노하우 Part 2: 테스트 코드로부터 피드백 받기“사내 기술 블로그에 이미 다룬 바 있습니다. 폭넓은 테스트를 작성하고 실행하기 위해서는 테스트 코드의 간편한 작성이 필수적입니다. 본 포스팅에서는 Spring Data MongoDB를 사용하여 Given 절의 데이터 셋업을 쉽게 하는 방법을 소개하겠습니다.\n데이터 셋업의 어려움과 중요성\n위 이미지처럼 주문 테스트 코드에 대한 다양한 테스트 케이스를 작성하기 위해서는 다양한 데이터를 셋업 하는 것은 필수적입니다. 다양한 테스트 케이스를 작성하지 못하면 테스트 케이스가 커버하는 범위가 좁아지며, 이로 인해 테스트 코드로부터 양질의 피드백을 받을 수 없게 됩니다. 따라서, 테스트 코드를 쉽게 작성하고 다양한 시나리오를 손쉽게 검증할 수 있는 환경을 만드는 것이 중요합니다.\n스프링에서는 @Sql 어노테이션을 이용해 테스트 데이터를 간단히 셋업 할 수 있으며, 이를 통해 테스트 케이스를 원활하게 확장할 수 있습니다. 이에 관한 자세한 방법은 Sql을 통해서 테스트 코드를 쉽게 작성하자” 포스팅에서 설명하고 있습니다. 해당 포스팅에서는 Sql을 활용하여 다양한 테스트 데이터를 쉽게 구성하는 방법을 제공합니다.\nSQL 파일을 이용한 데이터 셋업 방식12345678910111213141516171819202122@SqlGroup(    Sql(        value = [&quot;/schema.sql&quot;, &quot;/order-setup.sql&quot;, &quot;/coupon.sql&quot;, &quot;product.sql&quot;],        config = SqlConfig(            dataSource = &quot;dataSource&quot;,            transactionManager = &quot;transactionManager&quot;        ),        executionPhase = Sql.ExecutionPhase.BEFORE_TEST_METHOD    ),    Sql(        value = [&quot;/delete.sql&quot;],        config = SqlConfig(            dataSource = &quot;dataSource&quot;,            transactionManager = &quot;transactionManager&quot;        ),        executionPhase = Sql.ExecutionPhase.AFTER_TEST_METHOD    ))@Testfun `sql test code`() &#123;    // test code&#125;\n\n@SqlGroup 어노테이션을 사용하면 *.sql 파일을 통해 테스트 데이터를 쉽게 준비할 수 있습니다. 이렇게 데이터를 만들면 setter를 막아 데이터 변경 단위를 논리적으로 제공하는 경우라면 큰 장점이 있습니다.\n\n\nOrder라는 엔티티 객체를 테스트 코드를 작성하려면 특정 Snapshot 상태로 만들어야 한다.\n테스트 코드를 작성하는 구간은 상품 준비 -&gt; 배송시작 임으로 해당 객체를 상품 준비 상태로 만들어야 한다.\n하지만 단순 setter가 없기 때문에 상품 준비 중 객체로 직접 만드는 것이 어려운 부분이 있다.\n\n이런 경우 *.sql 파일을 활용하면, setter가 없는 객체에 대해서도 비즈니스 로직의 제약 없이 테스트 데이터를 간편하게 준비할 수 있어, 다양한 테스트 케이스를 쉽게 설정할 수 있습니다.\nJSON 파일을 이용한 테스트 데이터 셋업 방식@Sql와 같은 어노테이 어노테이션을 제공해주지 않기 때문에 직접 만들어야 합니다. 우선 적용된 코드부터 살펴보도록하겠습니다.\nDocument123456789101112131415161718192021222324252627@Document(collection = &quot;foo&quot;)data class Foo(    @Field(&quot;address_detail&quot;)    var addressDetail: String) : Auditable()@Document(collection = &quot;bar&quot;)data class Bar(    @Field(&quot;email&quot;)    var email: String) : Auditable()abstract class Auditable &#123;    @Id    var id: ObjectId? = null        internal set    @Field(name = &quot;created_at&quot;)    @CreatedDate    open lateinit var createdAt: LocalDateTime        internal set    @Field(name = &quot;updated_at&quot;)    @LastModifiedDate    open lateinit var updatedAt: LocalDateTime        internal set&#125;\n\n테스트를 위해 Foo, Bar Document를 간단한 필드들로 구성하며, Auditable을 상속하여 공통된 필드를 갖도록 합니다.\nMongoDataSetup 활용12345678910111213141516171819202122232425262728293031323334@MongoTestSupport //(1)@SpringBootTest@ActiveProfiles(&quot;test&quot;)@TestConstructor(autowireMode = TestConstructor.AutowireMode.ALL)class MongoDataSetupExecutionListenerBeforeTest(    private val mongoTemplate: MongoTemplate) &#123;    // (2)    @MongoDataSetup(        // [&#123;&quot;address_detail&quot;: &quot;1동, xxxx&quot;&#125;, &#123;&quot;address_detail&quot;: &quot;2동, xxxx&quot;&#125;]        jsonPath = &quot;/mongo-document-foo.json&quot;, // (3)        clazz = Foo::class, // (4)    )    @Test    @DisplayName(&quot;MongoDataSetup 단일 테스트&quot;)    fun mongoDataSetup() &#123;        // when        val fooDocuments = mongoTemplate.findAll&lt;Foo&gt;()        // then        then(fooDocuments).hasSize(2)        then(fooDocuments).allSatisfy(            Consumer &#123;                then(it.id).isNotNull()                then(it.addressDetail).isIn(                    &quot;1동, xxxx&quot;,                    &quot;2동, xxxx&quot;                )                then(it.createdAt).isNotNull()                then(it.updatedAt).isNotNull()            &#125;        )    &#125;&#125;\n\n적용된 코드부터 살펴보고 이후 구현 코드를 살펴보도록하겠습니다.\n\n(1): @MongoTestSupport 설정을 통해서 테스트 실행 리스너로 추가하여 데이터 설정을 자동화합니다.\n(2): @MongoDataSetup은 해당 JSON 파일일을 읽어 MongoDB에 삽입합니다.\n(3): jsonPath은 test/resources/ 디렉토리에 위치한 JSON 파일의 경로를 지정합니다. 마지막으로,\n(4): MongoDB에 삽입할 문서의 클래스를 명시합니다.\n\n\n@MongoDataSetup 어노테이션을 사용하면, JSON 파일을 통해 MongoDB 테스트 데이터를 간편하게 설정할 수 있으며, 테스트 실행 시 Foo Document 객체가 성공적으로 저장되어 조회되는 것을 확인할 수 있습니다.\n테스트 데이터 셋업 코드MongoDataSetup123456789101112131415/** * @param jsonPath json file의 경로를 작성한다. * @param clazz MongoDB에 저장할 Document 객체 * @param collectionName [clazz]와 Document collection 이름이 다른 경우 명시, 명시하지 않는 경우 [clazz]의 Document의 collection 으로 저장 * * @see com.example.mongostudy.MongoDataSetupExecutionListenerTest.mongoDataSetup * @see com.example.mongostudy.MongoDataSetupExecutionListenerTest.mongoDataSetupCollectionName */@Target(AnnotationTarget.FUNCTION)@Retention(AnnotationRetention.RUNTIME)annotation class MongoDataSetup(    val jsonPath: String,    val clazz: KClass&lt;*&gt;,    val collectionName: String = &quot;&quot;)\n\n단일 문서 데이터 셋업에 사용됩니다.\n123456789/** * 여러 데이터를 셋업이 필요한 경우 * @param mongoDataSetup * * @see com.example.mongostudy.MongoDataSetupExecutionListenerTest.mongoDataSetups */@Target(AnnotationTarget.FUNCTION, AnnotationTarget.ANNOTATION_CLASS)@Retention(AnnotationRetention.RUNTIME)annotation class MongoDataSetups(vararg val mongoDataSetup: MongoDataSetup)\n\n여러 문서의 데이터 셋업 시 사용합니다.\nMongoDataSetupExecutionListener123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778class MongoDataSetupExecutionListener : TestExecutionListener &#123;    /**     * 테스트 이전에 [MongoDataSetup]기반으로 Document를 생성한다.     */    override fun beforeTestMethod(testContext: TestContext) &#123;        val currentTestMethod = testContext.testMethod        val mongoDataSetup = currentTestMethod.getAnnotation(MongoDataSetup::class.java)        val mongoDataSetups = currentTestMethod.getAnnotation(MongoDataSetups::class.java)        when &#123;            mongoDataSetup != null -&gt; insertDocuments(mongoDataSetup, testContext)            mongoDataSetups != null -&gt; mongoDataSetups.mongoDataSetup.forEach &#123; document -&gt;                insertDocuments(document, testContext)            &#125;        &#125;    &#125;    /**     * 테스트가 끝난 이후 모든 모든 데이터를 삭제한다.     */    override fun afterTestMethod(testContext: TestContext) &#123;        val mongoTemplate = mongoTemplate(testContext)        val currentTestMethod = testContext.testMethod        val mongoDataSetup = currentTestMethod.getAnnotation(MongoDataSetup::class.java)        val mongoDataSetups = currentTestMethod.getAnnotation(MongoDataSetups::class.java)        when &#123;            mongoDataSetup != null -&gt; &#123;                when &#123;                    mongoDataSetup.collectionName.isEmpty() -&gt; mongoTemplate.dropCollection(mongoDataSetup.clazz.java)                    else -&gt; mongoTemplate.dropCollection(mongoDataSetup.collectionName)                &#125;            &#125;            mongoDataSetups != null -&gt; &#123;                mongoDataSetups.mongoDataSetup.forEach &#123;                    when &#123;                        it.collectionName.isEmpty() -&gt; mongoTemplate.dropCollection(it.clazz.java)                        else -&gt; mongoTemplate.dropCollection(it.collectionName)                    &#125;                &#125;            &#125;        &#125;    &#125;    private fun insertDocuments(mongoDataSetup: MongoDataSetup, testContext: TestContext) &#123;        val mongoTemplate = mongoTemplate(testContext)        val documents = objectMapper.readValue&lt;List&lt;Any&gt;&gt;(            readFile(mongoDataSetup.jsonPath),            objectMapper.typeFactory.constructCollectionType(List::class.java, mongoDataSetup.clazz.java)        )        if (documents.isNotEmpty()) &#123;            when &#123;                mongoDataSetup.collectionName.isEmpty() -&gt; mongoTemplate.insertAll(documents)                else -&gt; &#123;                    // 객체와, collectionName 일치하지 않는 경우는 collectionName을 지정하여 저장한다.                    for (document in documents) &#123;                        mongoTemplate.insert(document, mongoDataSetup.collectionName)                    &#125;                &#125;            &#125;        &#125;    &#125;    private fun mongoTemplate(testContext: TestContext): MongoTemplate &#123;        return testContext.applicationContext.getBean(MongoTemplate::class.java)    &#125;    private fun readFile(path: String): String &#123;        return String(ClassPathResource(path).inputStream.readBytes())    &#125;    private val objectMapper: ObjectMapper = ObjectMapper()        .registerKotlinModule()        .registerModules(JavaTimeModule(), Jdk8Module())        .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false)        .apply &#123; this.propertyNamingStrategy = PropertyNamingStrategies.SNAKE_CASE &#125;&#125;\n\nMongoDataSetupExecutionListener는 TestExecutionListener를 상속받아 구현되며, 스프링의 테스트 컨텍스트 프레임워크를 사용합니다. 이 리스너는 beforeTestMethod와 afterTestMethod 이벤트를 활용해 테스트 메소드 실행 전에 데이터를 준비하고, 실행 후에 데이터를 정리하는 기능을 수행합니다. 이 리스너는 TestContext에 의존하여 테스트 애플리케이션 컨텍스트에서 Bean을 쉽게 가져올 수 있으며, 예시에서는 MongoTemplate를 추출하는 데 사용되며 테스트 환경을 설정하거나, 테스트 데이터를 초기화하거나, 테스트 결과를 정리하는 등의 작업을 자동화하는 데 유용합니다. TestExecutionListener 인터페이스를 구현하고, 스프링의 테스트에 @TestExecutionListeners 어노테이션을 사용하여 리스너를 등록함으로써 활용할 수 있습니다.\nTestExecutionListeners 리스너 등록 방법123456789@TestExecutionListeners(    listeners = [        MongoDataSetupExecutionListener::class,        DependencyInjectionTestExecutionListener::class    ])@Retention(AnnotationRetention.RUNTIME)@Target(AnnotationTarget.CLASS)annotation class MongoTestSupport\n\nMongoDataSetupExecutionListener는 테스트에 필요한 리스너로, TestExecutionListeners 어노테이션을 통해 등록합니다. 이 과정을 단순화하기 위해 MongoTestSupport 어노테이션을 생성하여, TestExecutionListeners 설정을 손쉽게 적용할 수 있도록 합니다.\n1234@MongoTestSupportclass MongoDataSetupExecutionListenerBeforeTest &#123;    ...&#125;\n\n클래스 상단에 @MongoTestSupport 어노테이션을 추가함으로써, MongoDataSetupExecutionListener가 포함된 TestExecutionListeners를 쉽게 사용할 수 있습니다.\nMongoDataSetups 여러 문서의 데이터 셋업1234567891011121314151617181920212223242526272829303132333435363738394041424344@MongoDataSetups(    MongoDataSetup(        jsonPath = &quot;/mongo-document-bar.json&quot;,        clazz = Bar::class,    ),    MongoDataSetup(        jsonPath = &quot;/mongo-document-foo.json&quot;,        clazz = Foo::class,    ),)@Test@DisplayName(&quot;MongoDataSetups 여러개 테스트&quot;)fun mongoDataSetups() &#123;    // when    val fooDocuments = mongoTemplate.findAll&lt;Foo&gt;()    val barDocuments = mongoTemplate.findAll&lt;Bar&gt;()    // then    then(fooDocuments).hasSize(2)    then(fooDocuments).allSatisfy(        Consumer &#123;            then(it.id).isNotNull()            then(it.addressDetail).isIn(                &quot;1동, xxxx&quot;,                &quot;2동, xxxx&quot;            )            then(it.createdAt).isNotNull()            then(it.updatedAt).isNotNull()        &#125;    )    then(barDocuments).hasSize(2)    then(barDocuments).allSatisfy(        Consumer &#123;            then(it.id).isNotNull()            then(it.email).isIn(                &quot;aaa@asd.com&quot;,                &quot;bbb@asd.com&quot;            )            then(it.createdAt).isNotNull()            then(it.updatedAt).isNotNull()        &#125;    )&#125;\n\nMongoDataSetups를 사용하면 다수의 MongoDataSetup 인스턴스를 결합하여 여러 문서를 쉽게 설정할 수 있습니다.\nMongoDataSetup Projection 사용12345678910111213141516171819202122232425262728293031323334data class FooProjection(    @Field(&quot;address_detail&quot;)    var addressDetail: String,    @Field(&quot;created_at&quot;)    val createdAt: LocalDateTime,    @Field(&quot;updated_at&quot;)    val updatedAt: LocalDateTime)@MongoDataSetup(    jsonPath = &quot;/mongo-document-foo-projection.json&quot;,    clazz = FooProjection::class,    collectionName = &quot;foo&quot;)@Test@DisplayName(&quot;collectionName 기반으로 테스트&quot;)fun mongoDataSetupCollectionName() &#123;    // when    val fooDocuments = mongoTemplate.findAll&lt;Foo&gt;()    // then    then(fooDocuments).hasSize(2)    then(fooDocuments).allSatisfy(        Consumer &#123;            then(it.id).isNotNull()            then(it.addressDetail).isIn(                &quot;1동, xxxx&quot;,                &quot;2동, xxxx&quot;            )            then(it.createdAt).isNotNull()            then(it.updatedAt).isNotNull()        &#125;    )&#125;\n\nDocument 클래스가 아닌 Projection 객체를 이용해 데이터를 설정하려면, collectionName을 사용하여 명시적으로 컬렉션 이름을 지정함으로써 데이터를 원하는 컬렉션에 설정할 수 있습니다.\n편리성 제공123456@SpringBootTest@ActiveProfiles(&quot;test&quot;)@TestInstance(TestInstance.Lifecycle.PER_CLASS)@TestConstructor(autowireMode = TestConstructor.AutowireMode.ALL)@MongoTestSupportabstract class MongoApplicationTests\n\n@SpringBootTest 어노테이션을 사용하는 테스트 클래스에 @MongoTestSupport를 추가함으로써, 개별 테스트 클래스에서 어노테이션을 중복하여 작성할 필요 없이 모든 테스트에 적용될 수 있으며, 이를 통해 Application Context를 효율적으로 재사용할 수 있습니다. 이러한 방식은 공통적인 설정을 일관되게 관리하는 데에도 도움이 됩니다.\n@MongoDataSetup 적절한 사용@Sql 방식과 마찬가지로, JSON 파일 기반의 데이터 셋업에는 단점이 있습니다. 코드 내에서 객체를 생성하면 변수명과 주석을 통해 명확한 컨텍스트를 제공할 수 있는 반면, JSON 방식은 이러한 세부 사항을 전달하기 어렵습니다. 또한, Document 클래스의 코드 변경 시 관련 JSON 파일을 수동으로 업데이트해야 하는 번거로움이 있습니다.\n@MongoDataSetup을 사용한 데이터 셋업은 주로 대량의 데이터나 복잡한 데이터 조합이 필요한 로직을 테스트할 때 추천됩니다. 이런 케이스에서는 코드로 직접 작성할 경우 유지보수 비용이 증가하고, 변수명과 주석을 통한 컨텍스트 전달에 한계가 있기 때문에, 이러한 상황에서 @MongoDataSetup의 사용이 효과적입니다.\n마무리이 포스팅에서는 MongoDB 데이터를 쉽게 설정하는 방법을 소개했지만, 강조하고 싶은 주요 메시지는 테스트 코드의 중요성과 함께 테스트 환경 구성의 중요성입니다. 다양한 테스트 케이스를 작성할 수 있는 환경이 준비되어야만, 테스트 코드를 통해 유의미한 피드백을 얻고, 이를 통해 로직을 검증하고 코드 품질을 향상시킬 수 있습니다.\n","dateCreated":"2023-11-12T00:00:00+09:00","dateModified":"2025-01-31T06:29:31+09:00","datePublished":"2023-11-12T00:00:00+09:00","description":"테스트 코드의 가치가 널리 인정받으며, 이제 그 필요성을 언급하는 것은 의미가 없어졌습니다. 테스트 코드의 가장 큰 매력은 바로 구현 코드에 대한 실시간 피드백을 제공하고, 이를 바탕으로 구현 코드를 지속적으로 개선해 나갈 수 있다는 점입니다.","headline":"MongoDB 다양한 테스트 케이스를 커버할 수 있는 테스트 데이터 셋업 방법","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://cheese10yun.github.io/spring-data-mongo-test-setup/"},"publisher":{"@type":"Organization","name":"Yun","sameAs":["https://github.com/cheese10yun"],"image":"yun-icon.jpg","logo":{"@type":"ImageObject","url":"yun-icon.jpg"}},"url":"https://cheese10yun.github.io/spring-data-mongo-test-setup/","keywords":"Test, Mongo"}</script>
    <meta name="description" content="테스트 코드의 가치가 널리 인정받으며, 이제 그 필요성을 언급하는 것은 의미가 없어졌습니다. 테스트 코드의 가장 큰 매력은 바로 구현 코드에 대한 실시간 피드백을 제공하고, 이를 바탕으로 구현 코드를 지속적으로 개선해 나갈 수 있다는 점입니다.">
<meta property="og:type" content="blog">
<meta property="og:title" content="MongoDB 다양한 테스트 케이스를 커버할 수 있는 테스트 데이터 셋업 방법">
<meta property="og:url" content="https://cheese10yun.github.io/spring-data-mongo-test-setup/index.html">
<meta property="og:site_name" content="Yun Blog">
<meta property="og:description" content="테스트 코드의 가치가 널리 인정받으며, 이제 그 필요성을 언급하는 것은 의미가 없어졌습니다. 테스트 코드의 가장 큰 매력은 바로 구현 코드에 대한 실시간 피드백을 제공하고, 이를 바탕으로 구현 코드를 지속적으로 개선해 나갈 수 있다는 점입니다.">
<meta property="og:locale" content="ko_KR">
<meta property="og:image" content="https://raw.githubusercontent.com/cheese10yun/blog-sample/master/intellij-test/intellij-test/images/layer-4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/cheese10yun/blog-sample/master/intellij-test/intellij-test/images/order-flow.003.jpeg">
<meta property="og:image" content="https://github.com/cheese10yun/blog-sample/blob/391a198fecd66e4f972e8b5cab31e4ce906acadb/mongo-study/images/mongo-test-1.png?raw=true">
<meta property="article:published_time" content="2023-11-11T15:00:00.000Z">
<meta property="article:modified_time" content="2025-01-30T21:29:31.821Z">
<meta property="article:author" content="Yun">
<meta property="article:tag" content="Test">
<meta property="article:tag" content="Mongo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/cheese10yun/blog-sample/master/intellij-test/intellij-test/images/layer-4.png">
    
    
        
    
    
        <meta property="og:image" content="https://cheese10yun.github.io/assets/images/yun-icon.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90907312-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-90907312-1');
    </script>


    

    
        
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5813739623204880" crossorigin="anonymous"></script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Yun Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="저자에 대해 더 알아보기"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
                </a>
                <h4 class="sidebar-profile-name">Yun</h4>
                
                    <h5 class="sidebar-profile-bio"><p>기술 블로그</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="카테고리"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="태그"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="아카이브"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="검색"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">검색</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/cheese10yun"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/rss2.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            MongoDB 다양한 테스트 케이스를 커버할 수 있는 테스트 데이터 셋업 방법
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2023-11-12T00:00:00+09:00">
	
		    2023/11/12
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>테스트 코드의 가치가 널리 인정받으며, 이제 그 필요성을 언급하는 것은 의미가 없어졌습니다. 테스트 코드의 가장 큰 매력은 바로 구현 코드에 대한 실시간 피드백을 제공하고, 이를 바탕으로 구현 코드를 지속적으로 개선해 나갈 수 있다는 점입니다. 이 개념은 “<a target="_blank" rel="noopener" href="https://tech.kakaopay.com/post/mock-test-code-part-2/">실무에서 적용하는 테스트 코드 작성 방법과 노하우 Part 2: 테스트 코드로부터 피드백 받기</a>“사내 기술 블로그에 이미 다룬 바 있습니다. 폭넓은 테스트를 작성하고 실행하기 위해서는 테스트 코드의 간편한 작성이 필수적입니다. 본 포스팅에서는 Spring Data MongoDB를 사용하여 Given 절의 데이터 셋업을 쉽게 하는 방법을 소개하겠습니다.</p>
<h2 id="데이터-셋업의-어려움과-중요성"><a href="#데이터-셋업의-어려움과-중요성" class="headerlink" title="데이터 셋업의 어려움과 중요성"></a>데이터 셋업의 어려움과 중요성</h2><p><img src="https://raw.githubusercontent.com/cheese10yun/blog-sample/master/intellij-test/intellij-test/images/layer-4.png"></p>
<p>위 이미지처럼 주문 테스트 코드에 대한 다양한 테스트 케이스를 작성하기 위해서는 다양한 데이터를 셋업 하는 것은 필수적입니다. 다양한 테스트 케이스를 작성하지 못하면 테스트 케이스가 커버하는 범위가 좁아지며, 이로 인해 테스트 코드로부터 양질의 피드백을 받을 수 없게 됩니다. 따라서, <strong>테스트 코드를 쉽게 작성하고 다양한 시나리오를 손쉽게 검증할 수 있는 환경을 만드는 것이 중요합니다.</strong></p>
<p>스프링에서는 @Sql 어노테이션을 이용해 테스트 데이터를 간단히 셋업 할 수 있으며, 이를 통해 테스트 케이스를 원활하게 확장할 수 있습니다. 이에 관한 자세한 방법은 <a href="https://cheese10yun.github.io/sql-test/">Sql을 통해서 테스트 코드를 쉽게 작성하자” 포스팅에서 설명하고 있습니다</a>. 해당 포스팅에서는 Sql을 활용하여 다양한 테스트 데이터를 쉽게 구성하는 방법을 제공합니다.</p>
<h2 id="SQL-파일을-이용한-데이터-셋업-방식"><a href="#SQL-파일을-이용한-데이터-셋업-방식" class="headerlink" title="SQL 파일을 이용한 데이터 셋업 방식"></a>SQL 파일을 이용한 데이터 셋업 방식</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SqlGroup(</span></span><br><span class="line"><span class="meta">    Sql(</span></span><br><span class="line"><span class="meta">        value = [<span class="string">&quot;/schema.sql&quot;</span>, <span class="string">&quot;/order-setup.sql&quot;</span>, <span class="string">&quot;/coupon.sql&quot;</span>, <span class="string">&quot;product.sql&quot;</span>],</span></span><br><span class="line"><span class="meta">        config = SqlConfig(</span></span><br><span class="line"><span class="meta">            dataSource = <span class="string">&quot;dataSource&quot;</span>,</span></span><br><span class="line"><span class="meta">            transactionManager = <span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="meta">        ),</span></span><br><span class="line"><span class="meta">        executionPhase = Sql.ExecutionPhase.BEFORE_TEST_METHOD</span></span><br><span class="line"><span class="meta">    ),</span></span><br><span class="line"><span class="meta">    Sql(</span></span><br><span class="line"><span class="meta">        value = [<span class="string">&quot;/delete.sql&quot;</span>],</span></span><br><span class="line"><span class="meta">        config = SqlConfig(</span></span><br><span class="line"><span class="meta">            dataSource = <span class="string">&quot;dataSource&quot;</span>,</span></span><br><span class="line"><span class="meta">            transactionManager = <span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="meta">        ),</span></span><br><span class="line"><span class="meta">        executionPhase = Sql.ExecutionPhase.AFTER_TEST_METHOD</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> `sql test code`<span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// test code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@SqlGroup</code> 어노테이션을 사용하면 <code>*.sql</code> 파일을 통해 테스트 데이터를 쉽게 준비할 수 있습니다. 이렇게 데이터를 만들면 setter를 막아 데이터 변경 단위를 논리적으로 제공하는 경우라면 큰 장점이 있습니다.</p>
<p><img src="https://raw.githubusercontent.com/cheese10yun/blog-sample/master/intellij-test/intellij-test/images/order-flow.003.jpeg"></p>
<ol>
<li>Order라는 엔티티 객체를 테스트 코드를 작성하려면 특정 Snapshot 상태로 만들어야 한다.</li>
<li>테스트 코드를 작성하는 구간은 상품 준비 -&gt; 배송시작 임으로 해당 객체를 상품 준비 상태로 만들어야 한다.</li>
<li>하지만 단순 setter가 없기 때문에 상품 준비 중 객체로 직접 만드는 것이 어려운 부분이 있다.</li>
</ol>
<p><strong>이런 경우 <code>*.sql</code> 파일을 활용하면, setter가 없는 객체에 대해서도 비즈니스 로직의 제약 없이 테스트 데이터를 간편하게 준비할 수 있어, 다양한 테스트 케이스를 쉽게 설정할 수 있습니다.</strong></p>
<h2 id="JSON-파일을-이용한-테스트-데이터-셋업-방식"><a href="#JSON-파일을-이용한-테스트-데이터-셋업-방식" class="headerlink" title="JSON 파일을 이용한 테스트 데이터 셋업 방식"></a>JSON 파일을 이용한 테스트 데이터 셋업 방식</h2><p><code>@Sql</code>와 같은 어노테이 어노테이션을 제공해주지 않기 때문에 직접 만들어야 합니다. 우선 적용된 코드부터 살펴보도록하겠습니다.</p>
<h3 id="Document"><a href="#Document" class="headerlink" title="Document"></a>Document</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Document(collection = <span class="string">&quot;foo&quot;</span>)</span></span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">Foo</span>(</span><br><span class="line">    <span class="meta">@Field(<span class="string">&quot;address_detail&quot;</span>)</span></span><br><span class="line">    <span class="keyword">var</span> addressDetail: String</span><br><span class="line">) : Auditable()</span><br><span class="line"></span><br><span class="line"><span class="meta">@Document(collection = <span class="string">&quot;bar&quot;</span>)</span></span><br><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">Bar</span>(</span><br><span class="line">    <span class="meta">@Field(<span class="string">&quot;email&quot;</span>)</span></span><br><span class="line">    <span class="keyword">var</span> email: String</span><br><span class="line">) : Auditable()</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Auditable</span> &#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">var</span> id: ObjectId? = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">internal</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(name = <span class="string">&quot;created_at&quot;</span>)</span></span><br><span class="line">    <span class="meta">@CreatedDate</span></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> createdAt: LocalDateTime</span><br><span class="line">        <span class="keyword">internal</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(name = <span class="string">&quot;updated_at&quot;</span>)</span></span><br><span class="line">    <span class="meta">@LastModifiedDate</span></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> updatedAt: LocalDateTime</span><br><span class="line">        <span class="keyword">internal</span> <span class="keyword">set</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>테스트를 위해 Foo, Bar Document를 간단한 필드들로 구성하며, <code>Auditable</code>을 상속하여 공통된 필드를 갖도록 합니다.</p>
<h3 id="MongoDataSetup-활용"><a href="#MongoDataSetup-활용" class="headerlink" title="MongoDataSetup 활용"></a>MongoDataSetup 활용</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MongoTestSupport</span> <span class="comment">//(1)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@ActiveProfiles(<span class="string">&quot;test&quot;</span>)</span></span><br><span class="line"><span class="meta">@TestConstructor(autowireMode = TestConstructor.AutowireMode.ALL)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MongoDataSetupExecutionListenerBeforeTest</span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> mongoTemplate: MongoTemplate</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="comment">// (2)</span></span><br><span class="line">    <span class="meta">@MongoDataSetup(</span></span><br><span class="line"><span class="meta">        // [&#123;<span class="string">&quot;address_detail&quot;</span>: <span class="string">&quot;1동, xxxx&quot;</span>&#125;, &#123;<span class="string">&quot;address_detail&quot;</span>: <span class="string">&quot;2동, xxxx&quot;</span>&#125;]</span></span><br><span class="line"><span class="meta">        jsonPath = <span class="string">&quot;/mongo-document-foo.json&quot;</span>, // (3)</span></span><br><span class="line"><span class="meta">        clazz = Foo::class, // (4)</span></span><br><span class="line"><span class="meta">    )</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="meta">@DisplayName(<span class="string">&quot;MongoDataSetup 단일 테스트&quot;</span>)</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">mongoDataSetup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// when</span></span><br><span class="line">        <span class="keyword">val</span> fooDocuments = mongoTemplate.findAll&lt;Foo&gt;()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// then</span></span><br><span class="line">        then(fooDocuments).hasSize(<span class="number">2</span>)</span><br><span class="line">        then(fooDocuments).allSatisfy(</span><br><span class="line">            Consumer &#123;</span><br><span class="line">                then(it.id).isNotNull()</span><br><span class="line">                then(it.addressDetail).isIn(</span><br><span class="line">                    <span class="string">&quot;1동, xxxx&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;2동, xxxx&quot;</span></span><br><span class="line">                )</span><br><span class="line">                then(it.createdAt).isNotNull()</span><br><span class="line">                then(it.updatedAt).isNotNull()</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>적용된 코드부터 살펴보고 이후 구현 코드를 살펴보도록하겠습니다.</p>
<ul>
<li>(1): <code>@MongoTestSupport</code> 설정을 통해서 테스트 실행 리스너로 추가하여 데이터 설정을 자동화합니다.</li>
<li>(2): <code>@MongoDataSetup</code>은 해당 JSON 파일일을 읽어 MongoDB에 삽입합니다.</li>
<li>(3): <code>jsonPath</code>은 <code>test/resources/</code> 디렉토리에 위치한 JSON 파일의 경로를 지정합니다. 마지막으로,</li>
<li>(4): MongoDB에 삽입할 문서의 클래스를 명시합니다.</li>
</ul>
<p><img src="https://github.com/cheese10yun/blog-sample/blob/391a198fecd66e4f972e8b5cab31e4ce906acadb/mongo-study/images/mongo-test-1.png?raw=true"></p>
<p><code>@MongoDataSetup</code> 어노테이션을 사용하면, JSON 파일을 통해 MongoDB 테스트 데이터를 간편하게 설정할 수 있으며, 테스트 실행 시 Foo Document 객체가 성공적으로 저장되어 조회되는 것을 확인할 수 있습니다.</p>
<h2 id="테스트-데이터-셋업-코드"><a href="#테스트-데이터-셋업-코드" class="headerlink" title="테스트 데이터 셋업 코드"></a>테스트 데이터 셋업 코드</h2><h3 id="MongoDataSetup"><a href="#MongoDataSetup" class="headerlink" title="MongoDataSetup"></a>MongoDataSetup</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> jsonPath json file의 경로를 작성한다.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> clazz MongoDB에 저장할 Document 객체</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> collectionName [clazz]와 Document collection 이름이 다른 경우 명시, 명시하지 않는 경우 [clazz]의 Document의 collection 으로 저장</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> com.example.mongostudy.MongoDataSetupExecutionListenerTest.mongoDataSetup</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> com.example.mongostudy.MongoDataSetupExecutionListenerTest.mongoDataSetupCollectionName</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(AnnotationTarget.FUNCTION)</span></span><br><span class="line"><span class="meta">@Retention(AnnotationRetention.RUNTIME)</span></span><br><span class="line"><span class="keyword">annotation</span> <span class="keyword">class</span> <span class="title class_">MongoDataSetup</span>(</span><br><span class="line">    <span class="keyword">val</span> jsonPath: String,</span><br><span class="line">    <span class="keyword">val</span> clazz: KClass&lt;*&gt;,</span><br><span class="line">    <span class="keyword">val</span> collectionName: String = <span class="string">&quot;&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>단일 문서 데이터 셋업에 사용됩니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 여러 데이터를 셋업이 필요한 경우</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> mongoDataSetup</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> com.example.mongostudy.MongoDataSetupExecutionListenerTest.mongoDataSetups</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(AnnotationTarget.FUNCTION, AnnotationTarget.ANNOTATION_CLASS)</span></span><br><span class="line"><span class="meta">@Retention(AnnotationRetention.RUNTIME)</span></span><br><span class="line"><span class="keyword">annotation</span> <span class="keyword">class</span> <span class="title class_">MongoDataSetups</span>(<span class="keyword">vararg</span> <span class="keyword">val</span> mongoDataSetup: MongoDataSetup)</span><br></pre></td></tr></table></figure>

<p>여러 문서의 데이터 셋업 시 사용합니다.</p>
<h3 id="MongoDataSetupExecutionListener"><a href="#MongoDataSetupExecutionListener" class="headerlink" title="MongoDataSetupExecutionListener"></a>MongoDataSetupExecutionListener</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MongoDataSetupExecutionListener</span> : <span class="type">TestExecutionListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 테스트 이전에 [MongoDataSetup]기반으로 Document를 생성한다.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">beforeTestMethod</span><span class="params">(testContext: <span class="type">TestContext</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> currentTestMethod = testContext.testMethod</span><br><span class="line">        <span class="keyword">val</span> mongoDataSetup = currentTestMethod.getAnnotation(MongoDataSetup::<span class="keyword">class</span>.java)</span><br><span class="line">        <span class="keyword">val</span> mongoDataSetups = currentTestMethod.getAnnotation(MongoDataSetups::<span class="keyword">class</span>.java)</span><br><span class="line">        <span class="keyword">when</span> &#123;</span><br><span class="line">            mongoDataSetup != <span class="literal">null</span> -&gt; insertDocuments(mongoDataSetup, testContext)</span><br><span class="line">            mongoDataSetups != <span class="literal">null</span> -&gt; mongoDataSetups.mongoDataSetup.forEach &#123; document -&gt;</span><br><span class="line">                insertDocuments(document, testContext)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 테스트가 끝난 이후 모든 모든 데이터를 삭제한다.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">afterTestMethod</span><span class="params">(testContext: <span class="type">TestContext</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> mongoTemplate = mongoTemplate(testContext)</span><br><span class="line">        <span class="keyword">val</span> currentTestMethod = testContext.testMethod</span><br><span class="line">        <span class="keyword">val</span> mongoDataSetup = currentTestMethod.getAnnotation(MongoDataSetup::<span class="keyword">class</span>.java)</span><br><span class="line">        <span class="keyword">val</span> mongoDataSetups = currentTestMethod.getAnnotation(MongoDataSetups::<span class="keyword">class</span>.java)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">when</span> &#123;</span><br><span class="line">            mongoDataSetup != <span class="literal">null</span> -&gt; &#123;</span><br><span class="line">                <span class="keyword">when</span> &#123;</span><br><span class="line">                    mongoDataSetup.collectionName.isEmpty() -&gt; mongoTemplate.dropCollection(mongoDataSetup.clazz.java)</span><br><span class="line">                    <span class="keyword">else</span> -&gt; mongoTemplate.dropCollection(mongoDataSetup.collectionName)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            mongoDataSetups != <span class="literal">null</span> -&gt; &#123;</span><br><span class="line">                mongoDataSetups.mongoDataSetup.forEach &#123;</span><br><span class="line">                    <span class="keyword">when</span> &#123;</span><br><span class="line">                        it.collectionName.isEmpty() -&gt; mongoTemplate.dropCollection(it.clazz.java)</span><br><span class="line">                        <span class="keyword">else</span> -&gt; mongoTemplate.dropCollection(it.collectionName)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">insertDocuments</span><span class="params">(mongoDataSetup: <span class="type">MongoDataSetup</span>, testContext: <span class="type">TestContext</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">val</span> mongoTemplate = mongoTemplate(testContext)</span><br><span class="line">        <span class="keyword">val</span> documents = objectMapper.readValue&lt;List&lt;Any&gt;&gt;(</span><br><span class="line">            readFile(mongoDataSetup.jsonPath),</span><br><span class="line">            objectMapper.typeFactory.constructCollectionType(List::<span class="keyword">class</span>.java, mongoDataSetup.clazz.java)</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">if</span> (documents.isNotEmpty()) &#123;</span><br><span class="line">            <span class="keyword">when</span> &#123;</span><br><span class="line">                mongoDataSetup.collectionName.isEmpty() -&gt; mongoTemplate.insertAll(documents)</span><br><span class="line">                <span class="keyword">else</span> -&gt; &#123;</span><br><span class="line">                    <span class="comment">// 객체와, collectionName 일치하지 않는 경우는 collectionName을 지정하여 저장한다.</span></span><br><span class="line">                    <span class="keyword">for</span> (document <span class="keyword">in</span> documents) &#123;</span><br><span class="line">                        mongoTemplate.insert(document, mongoDataSetup.collectionName)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">mongoTemplate</span><span class="params">(testContext: <span class="type">TestContext</span>)</span></span>: MongoTemplate &#123;</span><br><span class="line">        <span class="keyword">return</span> testContext.applicationContext.getBean(MongoTemplate::<span class="keyword">class</span>.java)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">readFile</span><span class="params">(path: <span class="type">String</span>)</span></span>: String &#123;</span><br><span class="line">        <span class="keyword">return</span> String(ClassPathResource(path).inputStream.readBytes())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> objectMapper: ObjectMapper = ObjectMapper()</span><br><span class="line">        .registerKotlinModule()</span><br><span class="line">        .registerModules(JavaTimeModule(), Jdk8Module())</span><br><span class="line">        .configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, <span class="literal">false</span>)</span><br><span class="line">        .apply &#123; <span class="keyword">this</span>.propertyNamingStrategy = PropertyNamingStrategies.SNAKE_CASE &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>MongoDataSetupExecutionListener</code>는 <code>TestExecutionListener</code>를 상속받아 구현되며, 스프링의 테스트 컨텍스트 프레임워크를 사용합니다. 이 리스너는 <code>beforeTestMethod</code>와 <code>afterTestMethod</code> 이벤트를 활용해 테스트 메소드 실행 전에 데이터를 준비하고, 실행 후에 데이터를 정리하는 기능을 수행합니다. 이 리스너는 <code>TestContext</code>에 의존하여 테스트 애플리케이션 컨텍스트에서 Bean을 쉽게 가져올 수 있으며, 예시에서는 <code>MongoTemplate</code>를 추출하는 데 사용되며 테스트 환경을 설정하거나, <strong>테스트 데이터를 초기화하거나, 테스트 결과를 정리하는 등의 작업을 자동화하는 데 유용합니다.</strong> <code>TestExecutionListener</code> 인터페이스를 구현하고, 스프링의 테스트에 <code>@TestExecutionListeners</code> 어노테이션을 사용하여 리스너를 등록함으로써 활용할 수 있습니다.</p>
<h3 id="TestExecutionListeners-리스너-등록-방법"><a href="#TestExecutionListeners-리스너-등록-방법" class="headerlink" title="TestExecutionListeners 리스너 등록 방법"></a>TestExecutionListeners 리스너 등록 방법</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TestExecutionListeners(</span></span><br><span class="line"><span class="meta">    listeners = [</span></span><br><span class="line"><span class="meta">        MongoDataSetupExecutionListener::class,</span></span><br><span class="line"><span class="meta">        DependencyInjectionTestExecutionListener::class</span></span><br><span class="line"><span class="meta">    ]</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="meta">@Retention(AnnotationRetention.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(AnnotationTarget.CLASS)</span></span><br><span class="line"><span class="keyword">annotation</span> <span class="keyword">class</span> <span class="title class_">MongoTestSupport</span></span><br></pre></td></tr></table></figure>

<p><code>MongoDataSetupExecutionListener</code>는 테스트에 필요한 리스너로, <code>TestExecutionListeners</code> 어노테이션을 통해 등록합니다. 이 과정을 단순화하기 위해 <code>MongoTestSupport</code> 어노테이션을 생성하여, <code>TestExecutionListeners</code> 설정을 손쉽게 적용할 수 있도록 합니다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MongoTestSupport</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MongoDataSetupExecutionListenerBeforeTest</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>클래스 상단에 <code>@MongoTestSupport</code> 어노테이션을 추가함으로써, <code>MongoDataSetupExecutionListener</code>가 포함된 <code>TestExecutionListeners</code>를 쉽게 사용할 수 있습니다.</p>
<h3 id="MongoDataSetups-여러-문서의-데이터-셋업"><a href="#MongoDataSetups-여러-문서의-데이터-셋업" class="headerlink" title="MongoDataSetups 여러 문서의 데이터 셋업"></a>MongoDataSetups 여러 문서의 데이터 셋업</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MongoDataSetups(</span></span><br><span class="line"><span class="meta">    MongoDataSetup(</span></span><br><span class="line"><span class="meta">        jsonPath = <span class="string">&quot;/mongo-document-bar.json&quot;</span>,</span></span><br><span class="line"><span class="meta">        clazz = Bar::class,</span></span><br><span class="line"><span class="meta">    ),</span></span><br><span class="line"><span class="meta">    MongoDataSetup(</span></span><br><span class="line"><span class="meta">        jsonPath = <span class="string">&quot;/mongo-document-foo.json&quot;</span>,</span></span><br><span class="line"><span class="meta">        clazz = Foo::class,</span></span><br><span class="line"><span class="meta">    ),</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisplayName(<span class="string">&quot;MongoDataSetups 여러개 테스트&quot;</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">mongoDataSetups</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// when</span></span><br><span class="line">    <span class="keyword">val</span> fooDocuments = mongoTemplate.findAll&lt;Foo&gt;()</span><br><span class="line">    <span class="keyword">val</span> barDocuments = mongoTemplate.findAll&lt;Bar&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// then</span></span><br><span class="line">    then(fooDocuments).hasSize(<span class="number">2</span>)</span><br><span class="line">    then(fooDocuments).allSatisfy(</span><br><span class="line">        Consumer &#123;</span><br><span class="line">            then(it.id).isNotNull()</span><br><span class="line">            then(it.addressDetail).isIn(</span><br><span class="line">                <span class="string">&quot;1동, xxxx&quot;</span>,</span><br><span class="line">                <span class="string">&quot;2동, xxxx&quot;</span></span><br><span class="line">            )</span><br><span class="line">            then(it.createdAt).isNotNull()</span><br><span class="line">            then(it.updatedAt).isNotNull()</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    then(barDocuments).hasSize(<span class="number">2</span>)</span><br><span class="line">    then(barDocuments).allSatisfy(</span><br><span class="line">        Consumer &#123;</span><br><span class="line">            then(it.id).isNotNull()</span><br><span class="line">            then(it.email).isIn(</span><br><span class="line">                <span class="string">&quot;aaa@asd.com&quot;</span>,</span><br><span class="line">                <span class="string">&quot;bbb@asd.com&quot;</span></span><br><span class="line">            )</span><br><span class="line">            then(it.createdAt).isNotNull()</span><br><span class="line">            then(it.updatedAt).isNotNull()</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>MongoDataSetups</code>를 사용하면 다수의 <code>MongoDataSetup</code> 인스턴스를 결합하여 여러 문서를 쉽게 설정할 수 있습니다.</p>
<h3 id="MongoDataSetup-Projection-사용"><a href="#MongoDataSetup-Projection-사용" class="headerlink" title="MongoDataSetup Projection 사용"></a>MongoDataSetup Projection 사용</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span> <span class="keyword">class</span> <span class="title class_">FooProjection</span>(</span><br><span class="line">    <span class="meta">@Field(<span class="string">&quot;address_detail&quot;</span>)</span></span><br><span class="line">    <span class="keyword">var</span> addressDetail: String,</span><br><span class="line">    <span class="meta">@Field(<span class="string">&quot;created_at&quot;</span>)</span></span><br><span class="line">    <span class="keyword">val</span> createdAt: LocalDateTime,</span><br><span class="line">    <span class="meta">@Field(<span class="string">&quot;updated_at&quot;</span>)</span></span><br><span class="line">    <span class="keyword">val</span> updatedAt: LocalDateTime</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="meta">@MongoDataSetup(</span></span><br><span class="line"><span class="meta">    jsonPath = <span class="string">&quot;/mongo-document-foo-projection.json&quot;</span>,</span></span><br><span class="line"><span class="meta">    clazz = FooProjection::class,</span></span><br><span class="line"><span class="meta">    collectionName = <span class="string">&quot;foo&quot;</span></span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisplayName(<span class="string">&quot;collectionName 기반으로 테스트&quot;</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">mongoDataSetupCollectionName</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// when</span></span><br><span class="line">    <span class="keyword">val</span> fooDocuments = mongoTemplate.findAll&lt;Foo&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// then</span></span><br><span class="line">    then(fooDocuments).hasSize(<span class="number">2</span>)</span><br><span class="line">    then(fooDocuments).allSatisfy(</span><br><span class="line">        Consumer &#123;</span><br><span class="line">            then(it.id).isNotNull()</span><br><span class="line">            then(it.addressDetail).isIn(</span><br><span class="line">                <span class="string">&quot;1동, xxxx&quot;</span>,</span><br><span class="line">                <span class="string">&quot;2동, xxxx&quot;</span></span><br><span class="line">            )</span><br><span class="line">            then(it.createdAt).isNotNull()</span><br><span class="line">            then(it.updatedAt).isNotNull()</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Document 클래스가 아닌 Projection 객체를 이용해 데이터를 설정하려면, collectionName을 사용하여 명시적으로 컬렉션 이름을 지정함으로써 데이터를 원하는 컬렉션에 설정할 수 있습니다.</p>
<h2 id="편리성-제공"><a href="#편리성-제공" class="headerlink" title="편리성 제공"></a>편리성 제공</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@ActiveProfiles(<span class="string">&quot;test&quot;</span>)</span></span><br><span class="line"><span class="meta">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span></span><br><span class="line"><span class="meta">@TestConstructor(autowireMode = TestConstructor.AutowireMode.ALL)</span></span><br><span class="line"><span class="meta">@MongoTestSupport</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">MongoApplicationTests</span></span><br></pre></td></tr></table></figure>

<p><code>@SpringBootTest</code> 어노테이션을 사용하는 테스트 클래스에 <code>@MongoTestSupport</code>를 추가함으로써, 개별 테스트 클래스에서 어노테이션을 중복하여 작성할 필요 없이 모든 테스트에 적용될 수 있으며, 이를 통해 Application Context를 효율적으로 재사용할 수 있습니다. 이러한 방식은 공통적인 설정을 일관되게 관리하는 데에도 도움이 됩니다.</p>
<h2 id="MongoDataSetup-적절한-사용"><a href="#MongoDataSetup-적절한-사용" class="headerlink" title="@MongoDataSetup 적절한 사용"></a>@MongoDataSetup 적절한 사용</h2><p><code>@Sql</code> 방식과 마찬가지로, JSON 파일 기반의 데이터 셋업에는 단점이 있습니다. 코드 내에서 객체를 생성하면 변수명과 주석을 통해 명확한 컨텍스트를 제공할 수 있는 반면, JSON 방식은 이러한 세부 사항을 전달하기 어렵습니다. 또한, <code>Document</code> 클래스의 코드 변경 시 관련 JSON 파일을 수동으로 업데이트해야 하는 번거로움이 있습니다.</p>
<p><strong><code>@MongoDataSetup</code>을 사용한 데이터 셋업은 주로 대량의 데이터나 복잡한 데이터 조합이 필요한 로직을 테스트할 때 추천됩니다.</strong> 이런 케이스에서는 코드로 직접 작성할 경우 유지보수 비용이 증가하고, 변수명과 주석을 통한 컨텍스트 전달에 한계가 있기 때문에, 이러한 상황에서 <code>@MongoDataSetup</code>의 사용이 효과적입니다.</p>
<h2 id="마무리"><a href="#마무리" class="headerlink" title="마무리"></a>마무리</h2><p>이 포스팅에서는 MongoDB 데이터를 쉽게 설정하는 방법을 소개했지만, 강조하고 싶은 주요 메시지는 테스트 코드의 중요성과 함께 <strong>테스트 환경 구성의 중요성입니다.</strong> <strong>다양한 테스트 케이스를 작성할 수 있는 환경이 준비되어야만, 테스트 코드를 통해 유의미한 피드백을 얻고, 이를 통해 로직을 검증하고 코드 품질을 향상시킬 수 있습니다.</strong></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Mongo/" rel="tag">Mongo</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Test/" rel="tag">Test</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-data-mongodb-update-performance/"
                    data-tooltip="MongoDB Update 성능 측정 및 분석"
                    aria-label="이전: MongoDB Update 성능 측정 및 분석"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-data-mongo-repository/"
                    data-tooltip="Spring Data MongoDB Repository 확장"
                    aria-label="다음: Spring Data MongoDB Repository 확장"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>


<!-- Comment -->
<!--  utteranc comment -->

<script src="https://utteranc.es/client.js"
        repo="cheese10yun/blog-comment"
        issue-term="title"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Yun. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-data-mongodb-update-performance/"
                    data-tooltip="MongoDB Update 성능 측정 및 분석"
                    aria-label="이전: MongoDB Update 성능 측정 및 분석"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-data-mongo-repository/"
                    data-tooltip="Spring Data MongoDB Repository 확장"
                    aria-label="다음: Spring Data MongoDB Repository 확장"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                    title="Google+에 공유하기"
                    aria-label="Google+에 공유하기"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://cheese10yun.github.io/spring-data-mongo-test-setup/"
                        aria-label="Google+에 공유하기"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Google+에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
        
            <h4 id="about-card-name">Yun</h4>
        
            <div id="about-card-bio"><p>기술 블로그</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
