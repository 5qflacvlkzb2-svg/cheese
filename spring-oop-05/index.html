
<!DOCTYPE html>
<html lang="ko">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="naver-site-verification" content="a37ea649edf26e70c3de94f9cb034f9d6e11de3f" />
    <meta name="generator" content="Yun Blog">
    <title>Spring OOP 프로그래밍 예제(5) - 외부 API(PagerDuty) 호출 - Yun Blog</title>
    <meta name="author" content="Yun">
    
        <meta name="keywords" content="Node,Spring,Spring Boot,Spring Batch,Kotlin,기술 블로그,JPA,Mongo,MySQL,OOP,">
    
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yun","sameAs":["https://github.com/cheese10yun"],"image":"yun-icon.jpg"},"articleBody":"예제 코드는 Github : blog-sample에 공개 되어 있습니다.\n외부 API(PagerDuty) 호출#최근 외부 API를 통신하는 일들이 많이 있었고 최근 PagerDuty API 작업을 하면서 외부 API를 사용할 때 많은 시행착오와 고민을 나름 정리해 보았습니다.\nPagerDuty Request#1234567891011&#123;    &quot;routing_key&quot;: &quot;routing_key...&quot;,    &quot;event_action&quot;: &quot;only trigger, acknowledge, resolve&quot;,    &quot;images&quot;: [],    &quot;links&quot;: [],    &quot;payload&quot;: &#123;        &quot;summary&quot;: &quot;summary...(string)&quot;,        &quot;source&quot;: &quot;System...&quot;,        &quot;severity&quot;: &quot;only critical, error, warning, info&quot;    &#125;&#125;\n\nPagerDuty Response#12345&#123;  &quot;status&quot;: &quot;success&quot;,  &quot;message&quot;: &quot;Event processed&quot;,  &quot;dedup_key&quot;: &quot;samplekeyhere&quot;&#125;\n\nPagerDuty Document에 나와 있는 Request, Response를 JSON으로 정리했습니다. Request 값은 필수 값 위주로 정리했습니다.\nRequest, Response Class#12345678910111213141516171819202122232425262728293031323334353637383940414243@Getterpublic static class Request &#123;    @JsonProperty(&quot;event_action&quot;)    private final EventAction eventAction;    @JsonProperty(&quot;routing_key&quot;)    private final String routingKey = &quot;routingKey...&quot;;    private final Payload payload;    @Builder    public Request(final EventAction eventAction, final Payload payload) &#123;        this.eventAction = eventAction;        this.payload = payload;    &#125;&#125;@Getterpublic static class Payload &#123;    private final String summary;    private final String timestamp = ZonedDateTime.now().toOffsetDateTime().format(DateTimeFormatter.ISO_OFFSET_DATE_TIME);    private final Severity severity;    private final Group group;    private final Source source;    @JsonProperty(&quot;custom_details&quot;)    private final Object customDetails;    @Builder    public Payload(final String summary, final Severity severity, final Group group, final Source source, final Object customDetails) &#123;        this.summary = summary;        this.severity = severity;        this.group = group;        this.source = source;        this.customDetails = customDetails;    &#125;&#125;@Getterpublic static class Response &#123;    private String status;    private String message;    @JsonProperty(&quot;dedup_key&quot;)    private String dedupKey;&#125;\n\nRequest, Response에 대한 DTO 클래스 생성#위의 JSON을 클래스로 바인딩시킬 DTO 클래스를 생성해서 API에 대한 Request, Response를 관리하는 것이 바람직합니다. 간혹 Map, JSON(gsoon, jackson) 등을 이용해서 유연하게 두는 예도 있지만 저는 개인적으로 권장하지 않습니다. 가장 큰 이유는 해당 값에 무슨 데이터가 있는지 확인하기 어렵습니다. 코드 가독성이 심각하게 떨어지며 정확히 어떤 자료형인지 확인하기도 어렵습니다. 또 @JsonProperty를 통해서 해당 실제 JSON 키값과 객체의 멤버 필드 값을 다르게 설정 할 수 있습니다.\nSetter를 사용하지 않기#이전 포스팅에서도 Setter 사용하지 않기를 언급한 적이 있습니다. Response DTO 클래스 같은 경우는 더욱 Setter를 제공할 필요가 없지만, 관습적으로 Setter 메서드를 추가하는 경우가 많습니다. 해당 객체를 어디서든지 변경이 가능한 객체가 되기 때문에 명확한 이유 없이 관습적인 Setter는 반드시 지양 해야 합니다.\n반면 Request 객체는 필요한 값을 바인딩시켜 보내줘야 합니다. 이러한 경우는 Builder 패턴을 이용해서 객체를 생성하면 많은 장점이 있습니다. 제가 느끼는 대표적인 장점들 아래와 같습니다.\n1234PagerDutyDto.Request.builder()    .eventAction(PagerDutyDto.EventAction.acknowledge)    .payload(Payload ...)    .build();\n\n\n인자의 순서에 영향 받지 않습니다. 생성자로 생성했을 경우 인자의 순서가 중요하며, 특히 같은 자료형에 대한 인자는 실수할 수 있는 여지가 높습니다.\nSetter 메서드가 없어 변경 불가능 객체를 만들 수 있습니다.\n\n그렇다면 객체의 수정이 필요 하면 어떻게 어떻게 해야 할까요?\n12345678class User &#123;    private String email;    private String name;    public void changeEmail(String email) &#123;        this.email = email;    &#125;&#125;\n객체의 멤버필드를 수정 할 수 있는 수정 메소드를 제공 해주면 됩니다. 단순하게 setter라는 네이밍으로 공개하는 것보다 해당 메소드의 기능을 잘 표현하는 네이밍을 갖는 것이 적합합니다. 더 구체적인 내용은 이전 포스팅 Setter 사용하지 않기에 정리 되어 있습니다.\nEnum을 활용한 안전성 보장#123456&#123;    &quot;event_action&quot;: &quot;only trigger, acknowledge, resolve&quot;,    &quot;payload&quot;: &#123;        &quot;severity&quot;: &quot;only critical, error, warning, info&quot;    &#125;&#125;\nPagerDuty API event_action, payload.severity 의 value는 위에서 정의한 값 이외의 값이 넘어오면 status 400이 리턴 됩니다. 이러한 값들에 대해서는 아래 코드처럼 enum 클래스로 안전성을 확보하는 것이 바람직합니다.\n123456public enum EventAction &#123;    trigger, acknowledge, resolve&#125;public enum Severity &#123;    info, error, warn&#125;\nString으로 관리할 경우 해당 값 이외의 입력에 대한 예외코드를 작성하면 런타임시에 발생하게 됩니다. enum 클래스로 관리했을 경우 개발자는 해당 enum 값이 외에는 값을 넣을 수도 없게끔 강제하는 것이 실수를 줄이는 방법입니다. String은 변경 및 유지 보수에 취약합니다. 이처럼 API에서 강제된 항목들은 enum 클래스로 관리하는 것이 바람직합니다.\n각각의 메소드에 책임 부여#12345678910111213141516171819202122232425public void sendErrorMessage() &#123;    // 적절한 Error Message를 가공하는 책임    // 해당 메소드의 변경시 이유는 Error Message의 변경시에만 변경 이유를 갖는다    final PagerDutyDto.Request request = buildErrorMessage();    send(request);&#125;public void sendInfoMessage() &#123;    // 적절한 Info Message를 가공하는 책임    // 해당 메소드의 변경시 이유는 Info Message의 변경시에만 변경 이유를 갖는다    final PagerDutyDto.Request request = buildInfoMessage();    send(request);&#125;private PagerDutyDto.Response send(final PagerDutyDto.Request request) &#123;    // 넘겨 받은 request를 PagerDuty 에게 보내는 책임    // 해당 메소드의 변경시 이유는 PagerDuty API 변경시만 변경 이유를 갖는다. -&gt; Request, Response 변경이 대표적인 예    try &#123;        final String url = &quot;https://events.pagerduty.com/v2/enqueue&quot;;        return restTemplate.postForObject(url, request, PagerDutyDto.Response.class);    &#125; catch (HttpClientErrorException e) &#123;        log.error(e.getResponseBodyAsString(), e);        throw new RuntimeException(e);    &#125;&#125;\n\n\n클린 코드 출처\n작게 만들어라!\n함수를 만드는 첫 번째 규칙은 ‘작게!’다. 함수를 만드는 둘째 규칙은 ‘더 작게!’다. …중략한 가지만 해라!\n함수는 한 가지를 해야 한다. 그 한 가지를 잘해야 한다. 그 한 가지만을 해야 한다. … 중략\n\n클린 코드에서 언급했듯이 함수의 기본단위는 정말 작아야 한다고 생각합니다. 그래야 재사용성이 높아지며 가독성, 유지보수에 좋은 코드가 된다고 생각합니다.\nsendErrorMessage() 메소드는 적절하게 Error Message를 만들어서 send 메소드에게 전달해주는 것이 그 함수가 하는 일입니다. 함수의 크기가 작으며 적은 일을 수행하고 있습니다.\nsend() 메소드도 넘겨받은 request값을 PagerDutry API 에게 요청하고 그에 따른 응답값을 받는 일만 합니다. 그렇게 된 결과 sendInfoMessage() 메서드에서도 재사용성이 높아지고, 해당 함수가 하는 일이 단순해져서 가독성이 높아집니다. 또 위에서도 언급했듯이 PagerDuty API 변경시에만 해당 메소드가 변경됩니다. 그런 결과 유지 보수하기 편한 이점이 있다고 생각합니다.\n","dateCreated":"2018-07-06T00:00:00+09:00","dateModified":"2025-02-02T19:20:02+09:00","datePublished":"2018-07-06T00:00:00+09:00","description":"최근 외부 API를 통신하는 일들이 많이 있었고 최근 PagerDuty API 작업을 하면서 외부 API를 사용할 때 많은 시행착오와 고민을 나름 정리해 보았습니다.","headline":"Spring OOP 프로그래밍 예제(5) - 외부 API(PagerDuty) 호출","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://cheese10yun.github.io/spring-oop-05/"},"publisher":{"@type":"Organization","name":"Yun","sameAs":["https://github.com/cheese10yun"],"image":"yun-icon.jpg","logo":{"@type":"ImageObject","url":"yun-icon.jpg"}},"url":"https://cheese10yun.github.io/spring-oop-05/","keywords":"Spring, OOP"}</script>
    <meta name="description" content="최근 외부 API를 통신하는 일들이 많이 있었고 최근 PagerDuty API 작업을 하면서 외부 API를 사용할 때 많은 시행착오와 고민을 나름 정리해 보았습니다.">
<meta property="og:type" content="blog">
<meta property="og:title" content="Spring OOP 프로그래밍 예제(5) - 외부 API(PagerDuty) 호출">
<meta property="og:url" content="https://cheese10yun.github.io/spring-oop-05/index.html">
<meta property="og:site_name" content="Yun Blog">
<meta property="og:description" content="최근 외부 API를 통신하는 일들이 많이 있었고 최근 PagerDuty API 작업을 하면서 외부 API를 사용할 때 많은 시행착오와 고민을 나름 정리해 보았습니다.">
<meta property="og:locale" content="ko_KR">
<meta property="article:published_time" content="2018-07-05T15:00:00.000Z">
<meta property="article:modified_time" content="2025-02-02T10:20:02.448Z">
<meta property="article:author" content="Yun">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="OOP">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://cheese10yun.github.io/assets/images/yun-icon.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-90907312-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-90907312-1');
    </script>


    

    
        
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5813739623204880" crossorigin="anonymous"></script>
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Yun Blog
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="링크 열기: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="저자에 대해 더 알아보기"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
                </a>
                <h4 class="sidebar-profile-name">Yun</h4>
                
                    <h5 class="sidebar-profile-bio"><p>기술 블로그</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="태그"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="아카이브"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/cheese10yun"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/rss2.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Spring OOP 프로그래밍 예제(5) - 외부 API(PagerDuty) 호출
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2018-07-06T00:00:00+09:00">
	
		    2018/07/06
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>예제 코드는 <a target="_blank" rel="noopener" href="https://github.com/cheese10yun/blog-sample/tree/master/pagerduty">Github : blog-sample</a>에 공개 되어 있습니다.</p>
<h1><span id="oebu-api-pagerduty-hocul">외부 API(PagerDuty) 호출</span><a href="#oebu-api-pagerduty-hocul" class="header-anchor">#</a></h1><p>최근 외부 API를 통신하는 일들이 많이 있었고 최근 PagerDuty API 작업을 하면서 외부 API를 사용할 때 많은 시행착오와 고민을 나름 정리해 보았습니다.</p>
<h2><span id="pagerduty-request">PagerDuty Request</span><a href="#pagerduty-request" class="header-anchor">#</a></h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;routing_key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;routing_key...&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;event_action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;only trigger, acknowledge, resolve&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;images&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;payload&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;summary&quot;</span><span class="punctuation">:</span> <span class="string">&quot;summary...(string)&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;System...&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;severity&quot;</span><span class="punctuation">:</span> <span class="string">&quot;only critical, error, warning, info&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2><span id="pagerduty-response">PagerDuty Response</span><a href="#pagerduty-response" class="header-anchor">#</a></h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;success&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Event processed&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dedup_key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;samplekeyhere&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://v2.developer.pagerduty.com/docs/send-an-event-events-api-v2">PagerDuty Document</a>에 나와 있는 Request, Response를 JSON으로 정리했습니다. Request 값은 필수 값 위주로 정리했습니다.</p>
<h2><span id="request-response-class">Request, Response Class</span><a href="#request-response-class" class="header-anchor">#</a></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Request</span> &#123;</span><br><span class="line">    <span class="meta">@JsonProperty(&quot;event_action&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> EventAction eventAction;</span><br><span class="line">    <span class="meta">@JsonProperty(&quot;routing_key&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">routingKey</span> <span class="operator">=</span> <span class="string">&quot;routingKey...&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Payload payload;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Builder</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Request</span><span class="params">(<span class="keyword">final</span> EventAction eventAction, <span class="keyword">final</span> Payload payload)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.eventAction = eventAction;</span><br><span class="line">        <span class="built_in">this</span>.payload = payload;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Payload</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String summary;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">timestamp</span> <span class="operator">=</span> ZonedDateTime.now().toOffsetDateTime().format(DateTimeFormatter.ISO_OFFSET_DATE_TIME);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Severity severity;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Group group;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Source source;</span><br><span class="line">    <span class="meta">@JsonProperty(&quot;custom_details&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object customDetails;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Builder</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Payload</span><span class="params">(<span class="keyword">final</span> String summary, <span class="keyword">final</span> Severity severity, <span class="keyword">final</span> Group group, <span class="keyword">final</span> Source source, <span class="keyword">final</span> Object customDetails)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.summary = summary;</span><br><span class="line">        <span class="built_in">this</span>.severity = severity;</span><br><span class="line">        <span class="built_in">this</span>.group = group;</span><br><span class="line">        <span class="built_in">this</span>.source = source;</span><br><span class="line">        <span class="built_in">this</span>.customDetails = customDetails;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Response</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="meta">@JsonProperty(&quot;dedup_key&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String dedupKey;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3><span id="request-responsee-daehan-dto-keulraeseu-saengseong">Request, Response에 대한 DTO 클래스 생성</span><a href="#request-responsee-daehan-dto-keulraeseu-saengseong" class="header-anchor">#</a></h3><p>위의 JSON을 클래스로 바인딩시킬 DTO 클래스를 생성해서 API에 대한 Request, Response를 관리하는 것이 바람직합니다. 간혹 Map, JSON(gsoon, jackson) 등을 이용해서 유연하게 두는 예도 있지만 <strong>저는 개인적으로 권장하지 않습니다.</strong> 가장 큰 이유는 해당 값에 무슨 데이터가 있는지 확인하기 어렵습니다. 코드 가독성이 심각하게 떨어지며 정확히 어떤 자료형인지 확인하기도 어렵습니다. 또 @JsonProperty를 통해서 해당 실제 JSON 키값과 객체의 멤버 필드 값을 다르게 설정 할 수 있습니다.</p>
<h3><span id="setterreul-sayonghaji-anhgi">Setter를 사용하지 않기</span><a href="#setterreul-sayonghaji-anhgi" class="header-anchor">#</a></h3><p>이전 포스팅에서도 <a target="_blank" rel="noopener" href="https://github.com/cheese10yun/spring-jpa-best-practices/blob/master/doc/step-06.md">Setter 사용하지 않기</a>를 언급한 적이 있습니다. Response DTO 클래스 같은 경우는 더욱 Setter를 제공할 필요가 없지만, 관습적으로 Setter 메서드를 추가하는 경우가 많습니다. <strong>해당 객체를 어디서든지 변경이 가능한 객체가 되기 때문에 명확한 이유 없이 관습적인 Setter는 반드시 지양 해야 합니다.</strong></p>
<p>반면 Request 객체는 필요한 값을 바인딩시켜 보내줘야 합니다. 이러한 경우는 Builder 패턴을 이용해서 객체를 생성하면 많은 장점이 있습니다. 제가 느끼는 대표적인 장점들 아래와 같습니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PagerDutyDto.Request.builder()</span><br><span class="line">    .eventAction(PagerDutyDto.EventAction.acknowledge)</span><br><span class="line">    .payload(Payload ...)</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>

<ol>
<li>인자의 순서에 영향 받지 않습니다. 생성자로 생성했을 경우 인자의 순서가 중요하며, 특히 같은 자료형에 대한 인자는 실수할 수 있는 여지가 높습니다.</li>
<li><strong>Setter 메서드가 없어 변경 불가능 객체를 만들 수 있습니다.</strong></li>
</ol>
<p>그렇다면 객체의 수정이 필요 하면 어떻게 어떻게 해야 할까요?</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">changeEmail</span><span class="params">(String email)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>객체의 멤버필드를 수정 할 수 있는 수정 메소드를 제공 해주면 됩니다. 단순하게 setter라는 네이밍으로 공개하는 것보다 해당 메소드의 기능을 잘 표현하는 네이밍을 갖는 것이 적합합니다. 더 구체적인 내용은 이전 포스팅 <a target="_blank" rel="noopener" href="https://github.com/cheese10yun/spring-jpa-best-practices/blob/master/doc/step-06.md#updatemyaccount-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8">Setter 사용하지 않기</a>에 정리 되어 있습니다.</p>
<h2><span id="enumeul-hwalyonghan-anjeonseong-bojang">Enum을 활용한 안전성 보장</span><a href="#enumeul-hwalyonghan-anjeonseong-bojang" class="header-anchor">#</a></h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;event_action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;only trigger, acknowledge, resolve&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;payload&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;severity&quot;</span><span class="punctuation">:</span> <span class="string">&quot;only critical, error, warning, info&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>PagerDuty API event_action, payload.severity 의 value는 위에서 정의한 값 이외의 값이 넘어오면 status 400이 리턴 됩니다. 이러한 값들에 대해서는 아래 코드처럼 enum 클래스로 안전성을 확보하는 것이 바람직합니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EventAction</span> &#123;</span><br><span class="line">    trigger, acknowledge, resolve</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Severity</span> &#123;</span><br><span class="line">    info, error, warn</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>String으로 관리할 경우 해당 값 이외의 입력에 대한 예외코드를 작성하면 런타임시에 발생하게 됩니다. enum 클래스로 관리했을 경우 개발자는 해당 enum 값이 외에는 값을 넣을 수도 없게끔 강제하는 것이 실수를 줄이는 방법입니다. String은 변경 및 유지 보수에 취약합니다. 이처럼 API에서 강제된 항목들은 enum 클래스로 관리하는 것이 바람직합니다.</p>
<h2><span id="gaggagyi-mesodeue-caegim-buyeo">각각의 메소드에 책임 부여</span><a href="#gaggagyi-mesodeue-caegim-buyeo" class="header-anchor">#</a></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendErrorMessage</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 적절한 Error Message를 가공하는 책임</span></span><br><span class="line">    <span class="comment">// 해당 메소드의 변경시 이유는 Error Message의 변경시에만 변경 이유를 갖는다</span></span><br><span class="line">    <span class="keyword">final</span> PagerDutyDto.<span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> buildErrorMessage();</span><br><span class="line">    send(request);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendInfoMessage</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 적절한 Info Message를 가공하는 책임</span></span><br><span class="line">    <span class="comment">// 해당 메소드의 변경시 이유는 Info Message의 변경시에만 변경 이유를 갖는다</span></span><br><span class="line">    <span class="keyword">final</span> PagerDutyDto.<span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> buildInfoMessage();</span><br><span class="line">    send(request);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> PagerDutyDto.Response <span class="title function_">send</span><span class="params">(<span class="keyword">final</span> PagerDutyDto.Request request)</span> &#123;</span><br><span class="line">    <span class="comment">// 넘겨 받은 request를 PagerDuty 에게 보내는 책임</span></span><br><span class="line">    <span class="comment">// 해당 메소드의 변경시 이유는 PagerDuty API 변경시만 변경 이유를 갖는다. -&gt; Request, Response 변경이 대표적인 예</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;https://events.pagerduty.com/v2/enqueue&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.postForObject(url, request, PagerDutyDto.Response.class);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (HttpClientErrorException e) &#123;</span><br><span class="line">        log.error(e.getResponseBodyAsString(), e);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>클린 코드 출처</p>
<p><strong>작게 만들어라!</strong></p>
<p>함수를 만드는 첫 번째 규칙은 ‘작게!’다. 함수를 만드는 둘째 규칙은 ‘더 작게!’다. …중략<br><strong>한 가지만 해라!</strong></p>
<p>함수는 한 가지를 해야 한다. 그 한 가지를 잘해야 한다. 그 한 가지만을 해야 한다. … 중략</p>
</blockquote>
<p><strong>클린 코드에서 언급했듯이 함수의 기본단위는 정말 작아야 한다고 생각합니다. 그래야 재사용성이 높아지며 가독성, 유지보수에 좋은 코드가 된다고 생각합니다.</strong></p>
<p>sendErrorMessage() 메소드는 적절하게 Error Message를 만들어서 send 메소드에게 전달해주는 것이 그 함수가 하는 일입니다. 함수의 크기가 작으며 적은 일을 수행하고 있습니다.</p>
<p>send() 메소드도 넘겨받은 request값을 PagerDutry API 에게 요청하고 그에 따른 응답값을 받는 일만 합니다. 그렇게 된 결과 sendInfoMessage() 메서드에서도 재사용성이 높아지고, 해당 함수가 하는 일이 단순해져서 가독성이 높아집니다. 또 위에서도 언급했듯이 PagerDuty API 변경시에만 해당 메소드가 변경됩니다. 그런 결과 유지 보수하기 편한 이점이 있다고 생각합니다.</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">태그</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/OOP/" rel="tag">OOP</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Spring/" rel="tag">Spring</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/github-proejct/"
                    data-tooltip="Github로 프로젝트 관리하기 Part1"
                    aria-label="이전: Github로 프로젝트 관리하기 Part1"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-jpa-best-08/"
                    data-tooltip="Spring JPA Best Practices Step-08 - OneToOne 관계 설정 팁"
                    aria-label="다음: Spring JPA Best Practices Step-08 - OneToOne 관계 설정 팁"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/spring-oop-05/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/spring-oop-05/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        

                
                    <!--  utteranc comment -->

<script src="https://utteranc.es/client.js"
        repo="cheese10yun/blog-comment"
        issue-term="title"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

                

            
        
    </div>
</article>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Yun. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/github-proejct/"
                    data-tooltip="Github로 프로젝트 관리하기 Part1"
                    aria-label="이전: Github로 프로젝트 관리하기 Part1"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">이전</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/spring-jpa-best-08/"
                    data-tooltip="Spring JPA Best Practices Step-08 - OneToOne 관계 설정 팁"
                    aria-label="다음: Spring JPA Best Practices Step-08 - OneToOne 관계 설정 팁"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">다음</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="이 포스트 공유하기"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/spring-oop-05/"
                    title="Facebook에 공유하기"
                    aria-label="Facebook에 공유하기"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/spring-oop-05/"
                    title="Twitter에 공유하기"
                    aria-label="Twitter에 공유하기"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="맨 위로">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://cheese10yun.github.io/spring-oop-05/"
                        aria-label="Facebook에 공유하기"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Facebook에 공유하기</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://cheese10yun.github.io/spring-oop-05/"
                        aria-label="Twitter에 공유하기"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitter에 공유하기</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/yun-icon.jpg" alt="저자 이미지"/>
        
            <h4 id="about-card-name">Yun</h4>
        
            <div id="about-card-bio"><p>기술 블로그</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
